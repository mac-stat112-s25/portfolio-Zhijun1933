<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Trivariate Visualization â€“ COMP/STAT112 Notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../bw/bw-quad.html" rel="next">
<link href="../bw/bw-bi.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="../style/custom.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../bw/bw-uni.html">Best Work</a></li><li class="breadcrumb-item"><a href="../bw/bw-tri.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trivariate Visualization</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Zhijun He</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Best Work</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/bw-uni.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Univariate Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/bw-bi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bivariate Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/bw-tri.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trivariate Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/bw-quad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quadvariate Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/bw-spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Spatial Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/Zhijun He-Exam1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Exam 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/Zhijun He-Exam2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exam 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/Solo Project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Solo Project</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Cheat Sheet</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/Cheatsheet2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Reference Sheet 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bw/Cheatsheet3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Reference Sheet 2</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">In-class Activities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-uni.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Univariate Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-bi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bivariate Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-multi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multivariate Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/real-ica-spacial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Spacial Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-effective viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Effective Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-data wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-working with dates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Dates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-reshaping data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Reshaping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-joining data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Joining Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-working with factors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Factors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-working with strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Strings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-working with data import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Data Import</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ica/ica-EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#journey-into-multi-dimensional-data-visualization" id="toc-journey-into-multi-dimensional-data-visualization" class="nav-link active" data-scroll-target="#journey-into-multi-dimensional-data-visualization">Journey into Multi-Dimensional Data Visualization</a></li>
  <li><a href="#meeting-our-subjects-the-palmer-penguins" id="toc-meeting-our-subjects-the-palmer-penguins" class="nav-link" data-scroll-target="#meeting-our-subjects-the-palmer-penguins">Meeting Our Subjects: The Palmer Penguins</a></li>
  <li>
<a href="#the-visual-narrative-unfolds" id="toc-the-visual-narrative-unfolds" class="nav-link" data-scroll-target="#the-visual-narrative-unfolds">The Visual Narrative Unfolds</a>
  <ul class="collapse">
<li><a href="#chapter-1-species-differentiation---natures-distinct-designs" id="toc-chapter-1-species-differentiation---natures-distinct-designs" class="nav-link" data-scroll-target="#chapter-1-species-differentiation---natures-distinct-designs">Chapter 1: Species Differentiation - Natureâ€™s Distinct Designs</a></li>
  <li><a href="#chapter-2-the-size-connection---integrating-body-mass-into-my-story" id="toc-chapter-2-the-size-connection---integrating-body-mass-into-my-story" class="nav-link" data-scroll-target="#chapter-2-the-size-connection---integrating-body-mass-into-my-story">Chapter 2: The Size Connection - Integrating Body Mass into My Story</a></li>
  <li><a href="#chapter-3-the-gender-story---sexual-dimorphism-across-species" id="toc-chapter-3-the-gender-story---sexual-dimorphism-across-species" class="nav-link" data-scroll-target="#chapter-3-the-gender-story---sexual-dimorphism-across-species">Chapter 3: The Gender Story - Sexual Dimorphism Across Species</a></li>
  <li><a href="#chapter-4-the-complete-portrait---five-dimensions-in-one-view" id="toc-chapter-4-the-complete-portrait---five-dimensions-in-one-view" class="nav-link" data-scroll-target="#chapter-4-the-complete-portrait---five-dimensions-in-one-view">Chapter 4: The Complete Portrait - Five Dimensions in One View</a></li>
  <li><a href="#chapter-5-the-statistical-narrative---quantifying-relationships" id="toc-chapter-5-the-statistical-narrative---quantifying-relationships" class="nav-link" data-scroll-target="#chapter-5-the-statistical-narrative---quantifying-relationships">Chapter 5: The Statistical Narrative - Quantifying Relationships</a></li>
  <li><a href="#chapter-6-the-extremes---highlighting-notable-specimens" id="toc-chapter-6-the-extremes---highlighting-notable-specimens" class="nav-link" data-scroll-target="#chapter-6-the-extremes---highlighting-notable-specimens">Chapter 6: The Extremes - Highlighting Notable Specimens</a></li>
  <li><a href="#chapter-7-the-geographic-story---distributions-across-islands" id="toc-chapter-7-the-geographic-story---distributions-across-islands" class="nav-link" data-scroll-target="#chapter-7-the-geographic-story---distributions-across-islands">Chapter 7: The Geographic Story - Distributions Across Islands</a></li>
  </ul>
</li>
  <li><a href="#the-design-philosophy-behind-our-visual-story" id="toc-the-design-philosophy-behind-our-visual-story" class="nav-link" data-scroll-target="#the-design-philosophy-behind-our-visual-story">The Design Philosophy Behind Our Visual Story</a></li>
  <li><a href="#conclusion-the-power-of-visual-storytelling-with-data" id="toc-conclusion-the-power-of-visual-storytelling-with-data" class="nav-link" data-scroll-target="#conclusion-the-power-of-visual-storytelling-with-data">Conclusion: The Power of Visual Storytelling with Data</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../bw/bw-uni.html">Best Work</a></li><li class="breadcrumb-item"><a href="../bw/bw-tri.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Trivariate Visualization</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">Trivariate Visualization</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="journey-into-multi-dimensional-data-visualization" class="level1"><h1>Journey into Multi-Dimensional Data Visualization</h1>
<p>Imagine standing on the shores of Antarctica, observing penguins in their natural habitat. How would you capture and communicate the complex relationships between their physical characteristics? This is where trivariate visualization comes into playâ€”allowing us to tell richer, more nuanced data stories than would be possible with simpler charts.</p>
<p>While univariate visualizations show us distributions of single variables and bivariate plots reveal relationships between pairs, trivariate visualizations open a window into the complex interplay of three or more variables simultaneously. Our human visual system is remarkably adept at processing multiple visual dimensions, allowing us to encode additional variables through color, size, shape, and transparency.</p>
<p>In this document, weâ€™ll embark on a visual exploration of penguin morphology, using the Palmer Penguins dataset as my guide. Weâ€™ll progress from simple to complex visualizations, demonstrating how thoughtful design can reveal insights that might otherwise remain hidden in the data.</p>
</section><section id="meeting-our-subjects-the-palmer-penguins" class="level1"><h1>Meeting Our Subjects: The Palmer Penguins</h1>
<p>Before diving into visualization techniques, letâ€™s get acquainted with my subjects. The Palmer Penguins dataset contains measurements from three penguin species living on islands in the Palmer Archipelago, Antarctica. These charming birds provide an excellent case study for exploring multivariate relationships.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># Load the dataset</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">data</span>(penguins)</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># Create a summary table of key statistics by species</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>penguin_summary <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>  <span class="fu">summarize</span>(</span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="st">`</span><span class="at">Count</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="st">`</span><span class="at">Bill Length (mm)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="st">`</span><span class="at">Bill Depth (mm)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="st">`</span><span class="at">Flipper Length (mm)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="st">`</span><span class="at">Body Mass (g)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">0</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a>  )</span>
<span id="cb1-19"><a href="#cb1-19"></a></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co"># Create a nicely formatted table</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>penguin_summary <span class="sc">%&gt;%</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Summary Statistics of Penguin Morphology by Species"</span>,</span>
<span id="cb1-23"><a href="#cb1-23"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Count"</span>, <span class="st">"Bill Length (mm)"</span>, <span class="st">"Bill Depth (mm)"</span>, </span>
<span id="cb1-24"><a href="#cb1-24"></a>                    <span class="st">"Flipper Length (mm)"</span>, <span class="st">"Body Mass (g)"</span>),</span>
<span id="cb1-25"><a href="#cb1-25"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#264653"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Morphological Measurements (Mean Values)"</span> <span class="ot">=</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Summary Statistics of Penguin Morphology by Species</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide;"></th>
<th colspan="4" data-quarto-table-cell-role="th" style="text-align: center; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Morphological Measurements (Mean Values)
</div></th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold; color: white !important; background-color: rgba(38, 70, 83, 255) !important;">Species</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(38, 70, 83, 255) !important;">Count</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(38, 70, 83, 255) !important;">Bill Length (mm)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(38, 70, 83, 255) !important;">Bill Depth (mm)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(38, 70, 83, 255) !important;">Flipper Length (mm)</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold; color: white !important; background-color: rgba(38, 70, 83, 255) !important;">Body Mass (g)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Adelie</td>
<td style="text-align: right;">152</td>
<td style="text-align: right;">38.8</td>
<td style="text-align: right;">18.3</td>
<td style="text-align: right;">190.0</td>
<td style="text-align: right;">3701</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Chinstrap</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">48.8</td>
<td style="text-align: right;">18.4</td>
<td style="text-align: right;">195.8</td>
<td style="text-align: right;">3733</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Gentoo</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">47.5</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">217.2</td>
<td style="text-align: right;">5076</td>
</tr>
</tbody>
<tfoot>
<tr class="odd">
<td style="text-align: left; padding: 0;"><span style="font-style: italic;">Note: </span></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0;">
<sup></sup> Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Display sample of raw data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">head</span>(penguins, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Sample of Raw Penguin Data (First 5 Records)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb2-5"><a href="#cb2-5"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"250px"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:250px; overflow-x: scroll; width:100%; ">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of Raw Penguin Data (First 5 Records)</caption>
<thead><tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">species</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">island</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">bill_length_mm</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">bill_depth_mm</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">flipper_length_mm</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">body_mass_g</th>
<th data-quarto-table-cell-role="th" style="text-align: left; position: sticky; top: 0; background-color: #FFFFFF;">sex</th>
<th data-quarto-table-cell-role="th" style="text-align: right; position: sticky; top: 0; background-color: #FFFFFF;">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.1</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">3750</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">39.5</td>
<td style="text-align: right;">17.4</td>
<td style="text-align: right;">186</td>
<td style="text-align: right;">3800</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">40.3</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">3250</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">2007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adelie</td>
<td style="text-align: left;">Torgersen</td>
<td style="text-align: right;">36.7</td>
<td style="text-align: right;">19.3</td>
<td style="text-align: right;">193</td>
<td style="text-align: right;">3450</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">2007</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
<p>The dataset includes several variables that make it perfect for myy exploration:</p>
<ul>
<li>
<strong>Morphological measurements</strong>: bill length, bill depth, flipper length, and body mass</li>
<li>
<strong>Categorical variables</strong>: species, island, and sex</li>
<li>
<strong>Temporal data</strong>: year of observation</li>
</ul>
<p>Each of these variables tells part of a penguinâ€™s story, but their true narrative emerges when we examine them in combination. Letâ€™s begin our visual storytelling journey.</p>
</section><section id="the-visual-narrative-unfolds" class="level1"><h1>The Visual Narrative Unfolds</h1>
<section id="chapter-1-species-differentiation---natures-distinct-designs" class="level2"><h2 class="anchored" data-anchor-id="chapter-1-species-differentiation---natures-distinct-designs">Chapter 1: Species Differentiation - Natureâ€™s Distinct Designs</h2>
<p>My first visualization explores the fundamental question: How do penguin species differ in their bill morphology? This foundational story establishes the distinct evolutionary paths these species have taken.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Trivariate plot with color representing species</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb3-5"><a href="#cb3-5"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb3-6"><a href="#cb3-6"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="at">title =</span> <span class="st">"Evolutionary Divergence in Penguin Bill Morphology"</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="at">subtitle =</span> <span class="st">"Each species occupies a distinct region in the morphological space"</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="at">x =</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="at">y =</span> <span class="st">"Bill Depth (mm)"</span>,</span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb3-13"><a href="#cb3-13"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>  ) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-17"><a href="#cb3-17"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb3-19"><a href="#cb3-19"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb3-21"><a href="#cb3-21"></a>  ) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="co"># Add explanatory annotations</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>  <span class="fu">annotate</span>(<span class="st">"curve"</span>, <span class="at">x =</span> <span class="dv">42</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="at">xend =</span> <span class="dv">39</span>, <span class="at">yend =</span> <span class="dv">17</span>, </span>
<span id="cb3-24"><a href="#cb3-24"></a>           <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>)), <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">43</span>, <span class="at">y =</span> <span class="fl">13.7</span>, </span>
<span id="cb3-26"><a href="#cb3-26"></a>           <span class="at">label =</span> <span class="st">"Adelie: Shorter, deeper bills</span><span class="sc">\n</span><span class="st">adapted for their diet"</span>, </span>
<span id="cb3-27"><a href="#cb3-27"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray20"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb3-28"><a href="#cb3-28"></a>  <span class="fu">annotate</span>(<span class="st">"curve"</span>, <span class="at">x =</span> <span class="dv">52</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="at">xend =</span> <span class="dv">48</span>, <span class="at">yend =</span> <span class="dv">17</span>, </span>
<span id="cb3-29"><a href="#cb3-29"></a>           <span class="at">curvature =</span> <span class="fl">0.3</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>)), <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">52</span>, <span class="at">y =</span> <span class="fl">13.7</span>, </span>
<span id="cb3-31"><a href="#cb3-31"></a>           <span class="at">label =</span> <span class="st">"Chinstrap: Longer, narrower bills</span><span class="sc">\n</span><span class="st">for specialized feeding"</span>, </span>
<span id="cb3-32"><a href="#cb3-32"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray20"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>  <span class="fu">annotate</span>(<span class="st">"curve"</span>, <span class="at">x =</span> <span class="dv">55</span>, <span class="at">y =</span> <span class="fl">15.5</span>, <span class="at">xend =</span> <span class="dv">51</span>, <span class="at">yend =</span> <span class="dv">15</span>, </span>
<span id="cb3-34"><a href="#cb3-34"></a>           <span class="at">curvature =</span> <span class="fl">0.3</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>)), <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb3-35"><a href="#cb3-35"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">55</span>, <span class="at">y =</span> <span class="fl">15.5</span>, </span>
<span id="cb3-36"><a href="#cb3-36"></a>           <span class="at">label =</span> <span class="st">"Gentoo: Longest bills overall</span><span class="sc">\n</span><span class="st">reflecting different feeding strategy"</span>, </span>
<span id="cb3-37"><a href="#cb3-37"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray20"</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="bw-tri_files/figure-html/species-morphology-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This visualization reveals a compelling evolutionary story. Each penguin species has developed a distinct bill morphology, presumably adapted to their specific ecological niches and feeding strategies:</p>
<ul>
<li>
<strong>Adelie penguins</strong> feature shorter bills with greater depth, possibly evolved for capturing their preferred prey.</li>
<li>
<strong>Chinstrap penguins</strong> display longer, narrower bills, suggesting adaptation to different feeding techniques.</li>
<li>
<strong>Gentoo penguins</strong> have significantly longer bills with moderate depth, reflecting their unique ecological role.</li>
</ul>
<p>These distinct morphological signatures tell us about the evolutionary pressures that have shaped these species over time.</p>
</section><section id="chapter-2-the-size-connection---integrating-body-mass-into-my-story" class="level2"><h2 class="anchored" data-anchor-id="chapter-2-the-size-connection---integrating-body-mass-into-my-story">Chapter 2: The Size Connection - Integrating Body Mass into My Story</h2>
<p>Now letâ€™s deepen the narrative by incorporating body mass as a fourth dimension. This reveals how bill dimensions relate to overall size, adding another layer to our understanding of penguin morphology.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Adding body mass as a fourth variable through point size</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, </span>
<span id="cb4-3"><a href="#cb4-3"></a>                     <span class="at">color =</span> species, <span class="at">size =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="co"># Add points with transparency</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="co"># Use consistent species colors</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb4-8"><a href="#cb4-8"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb4-9"><a href="#cb4-9"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="co"># Scale size appropriately</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">3000</span>, <span class="dv">6000</span>, <span class="at">by =</span> <span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="co"># Add statistical ellipses to highlight groupings</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="fu">stat_ellipse</span>(<span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="co"># Labels</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-16"><a href="#cb4-16"></a>    <span class="at">title =</span> <span class="st">"The Complex Interplay of Bill Dimensions and Body Mass"</span>,</span>
<span id="cb4-17"><a href="#cb4-17"></a>    <span class="at">subtitle =</span> <span class="st">"Size patterns reveal evolutionary trade-offs between morphological features"</span>,</span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="at">x =</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="at">y =</span> <span class="st">"Bill Depth (mm)"</span>,</span>
<span id="cb4-20"><a href="#cb4-20"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb4-21"><a href="#cb4-21"></a>    <span class="at">size =</span> <span class="st">"Body Mass (g)"</span>,</span>
<span id="cb4-22"><a href="#cb4-22"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>  ) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>  <span class="co"># Theming</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-27"><a href="#cb4-27"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb4-28"><a href="#cb4-28"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb4-29"><a href="#cb4-29"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb4-30"><a href="#cb4-30"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>  ) <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>  <span class="co"># Add an annotation explaining the pattern</span></span>
<span id="cb4-33"><a href="#cb4-33"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">39</span>, <span class="at">y =</span> <span class="dv">21</span>, </span>
<span id="cb4-34"><a href="#cb4-34"></a>           <span class="at">label =</span> <span class="st">"Note how Gentoo penguins are not only</span><span class="sc">\n</span><span class="st">distinct in bill shape but also</span><span class="sc">\n</span><span class="st">consistently larger in body mass"</span>, </span>
<span id="cb4-35"><a href="#cb4-35"></a>           <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">color =</span> <span class="st">"#00A087"</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="bw-tri_files/figure-html/size-relationships-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As the story unfolds, I discover that Gentoo penguins arenâ€™t just different in bill shapeâ€”theyâ€™re also significantly larger overall. The size variations across species suggest different evolutionary strategies:</p>
<ul>
<li>Larger body mass in Gentoo penguins may provide advantages in their particular habitat, perhaps allowing them to dive deeper or survive in colder waters.</li>
<li>The relationship between bill dimensions and body mass reveals evolutionary trade-offs that each species has navigated.</li>
</ul>
<p>This visualization begins to paint a picture of penguin evolution as a complex optimization problem, with each species representing a different solution.</p>
</section><section id="chapter-3-the-gender-story---sexual-dimorphism-across-species" class="level2"><h2 class="anchored" data-anchor-id="chapter-3-the-gender-story---sexual-dimorphism-across-species">Chapter 3: The Gender Story - Sexual Dimorphism Across Species</h2>
<p>My narrative now branches to explore another fascinating aspect: how do males and females differ within each species? This chapter in my visual story examines sexual dimorphism, a key component of penguin biology.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Visualization</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">ggplot</span>(<span class="fu">na.omit</span>(penguins), <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="co"># Add a subtle point jitter with more space</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="co"># Add faceting by sex</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sex, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="co"># Use consistent species colors</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb5-9"><a href="#cb5-9"></a>                               <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb5-10"><a href="#cb5-10"></a>                               <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="co"># Add mean points with larger size and thicker border</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb5-13"><a href="#cb5-13"></a>               <span class="fu">aes</span>(<span class="at">fill =</span> species), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">stroke =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="co"># Use same colors for fill</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb5-16"><a href="#cb5-16"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb5-17"><a href="#cb5-17"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>),</span>
<span id="cb5-18"><a href="#cb5-18"></a>                   <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>  <span class="co"># Labels</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-21"><a href="#cb5-21"></a>    <span class="at">title =</span> <span class="st">"The Two Sides of Penguin Evolution: Male and Female Morphology"</span>,</span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="at">subtitle =</span> <span class="st">"Sexual dimorphism reveals different selection pressures across species"</span>,</span>
<span id="cb5-23"><a href="#cb5-23"></a>    <span class="at">x =</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="at">y =</span> <span class="st">"Bill Depth (mm)"</span>,</span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb5-27"><a href="#cb5-27"></a>  ) <span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>  <span class="co"># positioned legend elements</span></span>
<span id="cb5-29"><a href="#cb5-29"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">50</span>, <span class="at">y =</span> <span class="fl">13.5</span>, </span>
<span id="cb5-30"><a href="#cb5-30"></a>           <span class="at">label =</span> <span class="st">"Notice: The degree of sexual dimorphism varies by species,</span><span class="sc">\n</span><span class="st">suggesting different mating strategies and selection pressures"</span>, </span>
<span id="cb5-31"><a href="#cb5-31"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>  <span class="co">#  theme</span></span>
<span id="cb5-33"><a href="#cb5-33"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>  <span class="fu">theme</span>(</span>
<span id="cb5-35"><a href="#cb5-35"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"sans"</span>, <span class="at">color =</span> <span class="st">"grey20"</span>),</span>
<span id="cb5-36"><a href="#cb5-36"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb5-37"><a href="#cb5-37"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb5-38"><a href="#cb5-38"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray95"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb5-39"><a href="#cb5-39"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb5-40"><a href="#cb5-40"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb5-41"><a href="#cb5-41"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb5-42"><a href="#cb5-42"></a>  ) <span class="sc">+</span></span>
<span id="cb5-43"><a href="#cb5-43"></a>  <span class="co"># Add a custom legend for point types</span></span>
<span id="cb5-44"><a href="#cb5-44"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">38</span>, <span class="at">y =</span> <span class="fl">14.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#E64B35"</span>) <span class="sc">+</span></span>
<span id="cb5-45"><a href="#cb5-45"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">39.5</span>, <span class="at">y =</span> <span class="fl">14.5</span>, <span class="at">label =</span> <span class="st">"Individual penguins"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb5-46"><a href="#cb5-46"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">38</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">shape =</span> <span class="dv">21</span>, </span>
<span id="cb5-47"><a href="#cb5-47"></a>           <span class="at">fill =</span> <span class="st">"#E64B35"</span>, <span class="at">color =</span> <span class="st">"grey60"</span>, <span class="at">stroke =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">39.5</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="at">label =</span> <span class="st">"Species means"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="bw-tri_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="4800"></p>
</figure>
</div>
</div>
</div>
<p>The story of sexual dimorphism adds another fascinating layer to our understanding. While male penguins generally have larger bills than females across all species, the degree of dimorphism varies:</p>
<ul>
<li>The pronounced differences between males and females reflect sexual selection pressures and different reproductive roles.</li>
<li>The varying degree of dimorphism across species suggests different mating systems or environmental constraints.</li>
<li>The larger bills in males might be advantageous during courtship, territory defense, or providing for offspring.</li>
</ul>
<p>This chapter in our visual narrative reveals how evolution has shaped not just species differences, but also differences between sexes within each species.</p>
</section><section id="chapter-4-the-complete-portrait---five-dimensions-in-one-view" class="level2"><h2 class="anchored" data-anchor-id="chapter-4-the-complete-portrait---five-dimensions-in-one-view">Chapter 4: The Complete Portrait - Five Dimensions in One View</h2>
<p>Now weâ€™ll integrate multiple aspects of penguin morphology into a comprehensive visualization that tells a more complete story, incorporating flipper length, body mass, species, sex, and bill length all at once.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Improved multi-variable visualization</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">ggplot</span>(<span class="fu">na.omit</span>(penguins), </span>
<span id="cb6-3"><a href="#cb6-3"></a>       <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g, </span>
<span id="cb6-4"><a href="#cb6-4"></a>           <span class="at">color =</span> species, <span class="at">shape =</span> sex, <span class="at">size =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="co"># Add a subtle grid to aid in reading values</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">3000</span>, <span class="dv">6000</span>, <span class="at">by =</span> <span class="dv">500</span>), <span class="at">color =</span> <span class="st">"gray95"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">180</span>, <span class="dv">230</span>, <span class="at">by =</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"gray95"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="co"># Plot points</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="co"># Consistent color palette</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb6-12"><a href="#cb6-12"></a>                               <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb6-13"><a href="#cb6-13"></a>                               <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="co"># Format the y-axis with comma separators</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="co"># Better shape scale</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>  <span class="co"># Labels</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-21"><a href="#cb6-21"></a>    <span class="at">title =</span> <span class="st">"The Complete Penguin Portrait: A Five-Dimensional View"</span>,</span>
<span id="cb6-22"><a href="#cb6-22"></a>    <span class="at">subtitle =</span> <span class="st">"Revealing the interconnected nature of morphological adaptations"</span>,</span>
<span id="cb6-23"><a href="#cb6-23"></a>    <span class="at">x =</span> <span class="st">"Flipper Length (mm)"</span>,</span>
<span id="cb6-24"><a href="#cb6-24"></a>    <span class="at">y =</span> <span class="st">"Body Mass (g)"</span>,</span>
<span id="cb6-25"><a href="#cb6-25"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb6-26"><a href="#cb6-26"></a>    <span class="at">shape =</span> <span class="st">"Sex"</span>,</span>
<span id="cb6-27"><a href="#cb6-27"></a>    <span class="at">size =</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span id="cb6-28"><a href="#cb6-28"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>  ) <span class="sc">+</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>  <span class="co"># Add annotations highlighting key patterns</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">190</span>, <span class="at">y =</span> <span class="dv">5800</span>, </span>
<span id="cb6-32"><a href="#cb6-32"></a>           <span class="at">label =</span> <span class="st">"Gentoo penguins form a distinct cluster,</span><span class="sc">\n</span><span class="st">suggesting coordinated evolution of multiple traits"</span>, </span>
<span id="cb6-33"><a href="#cb6-33"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-34"><a href="#cb6-34"></a>  <span class="fu">annotate</span>(<span class="st">"curve"</span>, <span class="at">x =</span> <span class="dv">190</span>, <span class="at">y =</span> <span class="dv">5700</span>, <span class="at">xend =</span> <span class="dv">210</span>, <span class="at">yend =</span> <span class="dv">5500</span>, </span>
<span id="cb6-35"><a href="#cb6-35"></a>           <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>)), <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb6-36"><a href="#cb6-36"></a>  <span class="co"># Theme adjustments</span></span>
<span id="cb6-37"><a href="#cb6-37"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-38"><a href="#cb6-38"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-39"><a href="#cb6-39"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb6-40"><a href="#cb6-40"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb6-41"><a href="#cb6-41"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb6-42"><a href="#cb6-42"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb6-43"><a href="#cb6-43"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()  <span class="co"># Remove default grid in favor of custom grid</span></span>
<span id="cb6-44"><a href="#cb6-44"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="bw-tri_files/figure-html/comprehensive-morphology-1.png" class="img-fluid figure-img" width="4800"></p>
</figure>
</div>
</div>
</div>
<p>This comprehensive visualization integrates five different variables into a single coherent story, revealing how multiple morphological features evolve together:</p>
<ul>
<li>Flipper length and body mass show strong positive correlation within species.</li>
<li>Males (triangles) and females (circles) form distinct clusters within each species.</li>
<li>Bill length (represented by point size) increases along with body mass and flipper length.</li>
<li>Gentoo penguins form a completely separated cluster, highlighting their evolutionary divergence.</li>
</ul>
<p>This multi-dimensional view suggests that penguin morphology evolved as an integrated system rather than as individual traits, with natural selection operating on the entire morphological package.</p>
</section><section id="chapter-5-the-statistical-narrative---quantifying-relationships" class="level2"><h2 class="anchored" data-anchor-id="chapter-5-the-statistical-narrative---quantifying-relationships">Chapter 5: The Statistical Narrative - Quantifying Relationships</h2>
<p>Letâ€™s add a statistical layer to our story, highlighting the strength of relationships between different morphological features across species.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Enhanced statistical visualization</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> flipper_length_mm, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># Add custom gridlines</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">180</span>, <span class="dv">230</span>, <span class="at">by =</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"gray95"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">color =</span> <span class="st">"gray95"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="co"># Add points</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="co"># Add statistical elements</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="co"># Use consistent color scheme</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb7-13"><a href="#cb7-13"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb7-14"><a href="#cb7-14"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>  <span class="co"># Add axis labels</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="at">title =</span> <span class="st">"The Mathematical Signature of Evolution"</span>,</span>
<span id="cb7-18"><a href="#cb7-18"></a>    <span class="at">subtitle =</span> <span class="st">"Quantifying the relationship between bill length and flipper length"</span>,</span>
<span id="cb7-19"><a href="#cb7-19"></a>    <span class="at">x =</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span id="cb7-20"><a href="#cb7-20"></a>    <span class="at">y =</span> <span class="st">"Flipper Length (mm)"</span>,</span>
<span id="cb7-21"><a href="#cb7-21"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb7-22"><a href="#cb7-22"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb7-23"><a href="#cb7-23"></a>  ) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>  <span class="co"># Improve theme</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-27"><a href="#cb7-27"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb7-28"><a href="#cb7-28"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb7-29"><a href="#cb7-29"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.85</span>),</span>
<span id="cb7-30"><a href="#cb7-30"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb7-31"><a href="#cb7-31"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()  <span class="co"># Remove default grid</span></span>
<span id="cb7-32"><a href="#cb7-32"></a>  ) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33"></a>  <span class="co"># Add correlation annotations</span></span>
<span id="cb7-34"><a href="#cb7-34"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">35</span>, <span class="at">y =</span> <span class="dv">225</span>, </span>
<span id="cb7-35"><a href="#cb7-35"></a>           <span class="at">label =</span> <span class="st">"Gentoo: r = 0.71</span><span class="sc">\n</span><span class="st">Strongest correlation suggests</span><span class="sc">\n</span><span class="st">tighter evolutionary constraints"</span>, </span>
<span id="cb7-36"><a href="#cb7-36"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#00A087"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>) <span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">35</span>, <span class="at">y =</span> <span class="dv">215</span>, </span>
<span id="cb7-38"><a href="#cb7-38"></a>           <span class="at">label =</span> <span class="st">"Chinstrap: r = 0.63</span><span class="sc">\n</span><span class="st">Moderate correlation indicates</span><span class="sc">\n</span><span class="st">balanced selection pressures"</span>, </span>
<span id="cb7-39"><a href="#cb7-39"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#4DBBD5"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>) <span class="sc">+</span></span>
<span id="cb7-40"><a href="#cb7-40"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">35</span>, <span class="at">y =</span> <span class="dv">205</span>, </span>
<span id="cb7-41"><a href="#cb7-41"></a>           <span class="at">label =</span> <span class="st">"Adelie: r = 0.41</span><span class="sc">\n</span><span class="st">Weaker correlation suggests more</span><span class="sc">\n</span><span class="st">independent trait evolution"</span>, </span>
<span id="cb7-42"><a href="#cb7-42"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#E64B35"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="bw-tri_files/figure-html/statistical-relationships-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>This statistical chapter in our story provides a mathematical perspective on penguin evolution:</p>
<ul>
<li>The correlation coefficients quantify the strength of the relationship between bill length and flipper length.</li>
<li>Gentoo penguins show the strongest correlation (r = 0.71), suggesting their traits evolved under tighter constraints or stronger directional selection.</li>
<li>Adelie penguins show the weakest correlation (r = 0.41), suggesting more flexibility in how these traits evolved.</li>
<li>The confidence ellipses provide a visual representation of the variability within each species.</li>
</ul>
<p>These statistical patterns give us insight into the different evolutionary forces that have shaped each species.</p>
</section><section id="chapter-6-the-extremes---highlighting-notable-specimens" class="level2"><h2 class="anchored" data-anchor-id="chapter-6-the-extremes---highlighting-notable-specimens">Chapter 6: The Extremes - Highlighting Notable Specimens</h2>
<p>Our story now turns to individual penguins with extreme characteristics, exploring the boundaries of morphological variation.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Calculate species means for comparison</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>species_means <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">summarize</span>(</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="at">mean_bill_length =</span> <span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="at">mean_bill_depth =</span> <span class="fu">mean</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>  )</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co"># Identify interesting points for annotation</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>interesting_points <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">filter</span>(bill_length_mm <span class="sc">==</span> <span class="fu">max</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|</span> </span>
<span id="cb8-13"><a href="#cb8-13"></a>         bill_depth_mm <span class="sc">==</span> <span class="fu">max</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>  <span class="fu">distinct</span>(species, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># Create an improved annotated visualization</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>  <span class="co"># Add subtle background elements</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> species_means<span class="sc">$</span>mean_bill_depth, <span class="at">color =</span> <span class="st">"gray90"</span>, </span>
<span id="cb8-20"><a href="#cb8-20"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> species_means<span class="sc">$</span>mean_bill_length, <span class="at">color =</span> <span class="st">"gray90"</span>, </span>
<span id="cb8-22"><a href="#cb8-22"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="co"># Add points</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>  <span class="co"># Highlight interesting points</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> interesting_points, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>, </span>
<span id="cb8-27"><a href="#cb8-27"></a>             <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">stroke =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>  <span class="co"># Add annotations</span></span>
<span id="cb8-29"><a href="#cb8-29"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb8-30"><a href="#cb8-30"></a>    <span class="at">data =</span> interesting_points,</span>
<span id="cb8-31"><a href="#cb8-31"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Max "</span>, species, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Island: "</span>, island, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"Sex: "</span>, sex)),</span>
<span id="cb8-32"><a href="#cb8-32"></a>    <span class="at">box.padding =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-33"><a href="#cb8-33"></a>    <span class="at">point.padding =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-34"><a href="#cb8-34"></a>    <span class="at">force =</span> <span class="dv">2</span>,</span>
<span id="cb8-35"><a href="#cb8-35"></a>    <span class="at">segment.color =</span> <span class="st">"gray50"</span>,</span>
<span id="cb8-36"><a href="#cb8-36"></a>    <span class="at">size =</span> <span class="fl">3.5</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>  ) <span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>  <span class="co"># Consistent color scheme</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb8-40"><a href="#cb8-40"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb8-41"><a href="#cb8-41"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>  <span class="co"># Add labels</span></span>
<span id="cb8-43"><a href="#cb8-43"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-44"><a href="#cb8-44"></a>    <span class="at">title =</span> <span class="st">"Living on the Edge: Extreme Morphology in Penguin Populations"</span>,</span>
<span id="cb8-45"><a href="#cb8-45"></a>    <span class="at">subtitle =</span> <span class="st">"Examining penguins with maximum bill dimensions reveals morphological boundaries"</span>,</span>
<span id="cb8-46"><a href="#cb8-46"></a>    <span class="at">x =</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span id="cb8-47"><a href="#cb8-47"></a>    <span class="at">y =</span> <span class="st">"Bill Depth (mm)"</span>,</span>
<span id="cb8-48"><a href="#cb8-48"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb8-49"><a href="#cb8-49"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb8-50"><a href="#cb8-50"></a>  ) <span class="sc">+</span></span>
<span id="cb8-51"><a href="#cb8-51"></a>  <span class="co"># Improve theme</span></span>
<span id="cb8-52"><a href="#cb8-52"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-53"><a href="#cb8-53"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-54"><a href="#cb8-54"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb8-55"><a href="#cb8-55"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb8-56"><a href="#cb8-56"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb8-57"><a href="#cb8-57"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()  <span class="co"># Remove default grid</span></span>
<span id="cb8-58"><a href="#cb8-58"></a>  ) <span class="sc">+</span></span>
<span id="cb8-59"><a href="#cb8-59"></a>  <span class="co"># Add an explanatory annotation</span></span>
<span id="cb8-60"><a href="#cb8-60"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">37</span>, <span class="at">y =</span> <span class="dv">14</span>, </span>
<span id="cb8-61"><a href="#cb8-61"></a>           <span class="at">label =</span> <span class="st">"Dashed lines represent species means.</span><span class="sc">\n</span><span class="st">Extreme individuals may represent the</span><span class="sc">\n</span><span class="st">frontier of evolutionary adaptation."</span>, </span>
<span id="cb8-62"><a href="#cb8-62"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="bw-tri_files/figure-html/notable-specimens-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>This chapter focuses on extreme individuals, the outliers of penguin morphology:</p>
<ul>
<li>These specimens represent the boundaries of whatâ€™s possible within each speciesâ€™ morphological space.</li>
<li>The maximum bill dimensions might indicate the upper limits of beneficial adaptation.</li>
<li>The dashed lines representing species means provide context for just how extreme these individuals are.</li>
<li>Interestingly, these extreme specimens come from different islands and include both males and females.</li>
</ul>
<p>Examining these outliers gives us insight into the range of morphological variation that can still be viable within a species.</p>
</section><section id="chapter-7-the-geographic-story---distributions-across-islands" class="level2"><h2 class="anchored" data-anchor-id="chapter-7-the-geographic-story---distributions-across-islands">Chapter 7: The Geographic Story - Distributions Across Islands</h2>
<p>Our final chapter explores how penguin morphology varies across different geographic locations, adding a spatial dimension to our narrative.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Create a new visualization showing distribution across islands</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">ggplot</span>(<span class="fu">na.omit</span>(penguins), </span>
<span id="cb9-3"><a href="#cb9-3"></a>       <span class="fu">aes</span>(<span class="at">x =</span> island, <span class="at">y =</span> body_mass_g, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="co"># Create violin plots to show distribution</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="co"># Add jittered points</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="fu">aes</span>(<span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="co"># Add mean points</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="co"># Consistent color scheme</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb9-12"><a href="#cb9-12"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb9-13"><a href="#cb9-13"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb9-15"><a href="#cb9-15"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb9-16"><a href="#cb9-16"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>  <span class="co"># Format y-axis</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>  <span class="co"># Add labels</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-21"><a href="#cb9-21"></a>    <span class="at">title =</span> <span class="st">"The Geography of Penguin Evolution"</span>,</span>
<span id="cb9-22"><a href="#cb9-22"></a>    <span class="at">subtitle =</span> <span class="st">"How body mass distributions vary across different islands in the Palmer Archipelago"</span>,</span>
<span id="cb9-23"><a href="#cb9-23"></a>    <span class="at">x =</span> <span class="st">"Island"</span>,</span>
<span id="cb9-24"><a href="#cb9-24"></a>    <span class="at">y =</span> <span class="st">"Body Mass (g)"</span>,</span>
<span id="cb9-25"><a href="#cb9-25"></a>    <span class="at">fill =</span> <span class="st">"Species"</span>,</span>
<span id="cb9-26"><a href="#cb9-26"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb9-27"><a href="#cb9-27"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>  ) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>  <span class="co"># Improve theme</span></span>
<span id="cb9-30"><a href="#cb9-30"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-32"><a href="#cb9-32"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb9-33"><a href="#cb9-33"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb9-34"><a href="#cb9-34"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb9-35"><a href="#cb9-35"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb9-36"><a href="#cb9-36"></a>  ) <span class="sc">+</span></span>
<span id="cb9-37"><a href="#cb9-37"></a>  <span class="co"># Add annotations about geographic patterns</span></span>
<span id="cb9-38"><a href="#cb9-38"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">6100</span>, </span>
<span id="cb9-39"><a href="#cb9-39"></a>           <span class="at">label =</span> <span class="st">"Gentoo penguins are found exclusively on Biscoe Island,</span><span class="sc">\n</span><span class="st">suggesting geographic isolation may have</span><span class="sc">\n</span><span class="st">contributed to their distinct morphology"</span>, </span>
<span id="cb9-40"><a href="#cb9-40"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="bw-tri_files/figure-html/geographic-variation-1.png" class="img-fluid figure-img" width="2400"></p>
</figure>
</div>
</div>
</div>
<p>This final visualization reveals the geographic component of our penguin story:</p>
<ul>
<li>Species distribution is not uniform across islandsâ€”Gentoo penguins are found exclusively on Biscoe Island.</li>
<li>Adelie penguins are the most widely distributed, appearing on all three islands.</li>
<li>Chinstrap penguins are found only on Dream Island.</li>
<li>These geographic patterns suggest that isolation may have played a role in the evolution of the distinct morphological characteristics weâ€™ve observed.</li>
</ul>
<p>The spatial distribution of penguin species adds important context to our understanding of their morphological evolution.</p>
</section></section><section id="the-design-philosophy-behind-our-visual-story" class="level1"><h1>The Design Philosophy Behind Our Visual Story</h1>
<p>Creating effective trivariate (and beyond) visualizations requires careful consideration of design principles. Throughout my visual journey,I applied these key principles:</p>
<ol type="1">
<li><p><strong>Visual hierarchy</strong>: Using size, color, and opacity to guide attention to the most important elements first.</p></li>
<li><p><strong>Perceptual effectiveness</strong>: Matching visual encodings to data typesâ€”position for continuous variables, color for categorical ones, and size for continuous variables of secondary importance.</p></li>
<li><p><strong>Annotation</strong>: Adding textual explanations directly on the visualizations to guide interpretation and highlight key insights.</p></li>
<li><p><strong>Consistent visual language</strong>: Using the same color scheme throughout to maintain species identification across visualizations.</p></li>
<li><p><strong>Progressive disclosure</strong>: Building complexity gradually, from simple three-variable plots to more complex multi-dimensional visualizations.</p></li>
</ol>
<p>These principles have allowed us to tell a coherent visual story about penguin morphology that engages viewers and reveals complex ecological and evolutionary patterns.</p>
</section><section id="conclusion-the-power-of-visual-storytelling-with-data" class="level1"><h1>Conclusion: The Power of Visual Storytelling with Data</h1>
<p>My journey through penguin morphology demonstrates how trivariate visualization can transform raw data into a compelling narrative. By thoughtfully combining multiple visual dimensionsâ€”position, color, size, shape, and facetingâ€”Iâ€™ve uncovered complex relationships that tell a rich story about penguin evolution.I love penguins,we love penguins!</p>
</section><section id="references" class="level1"><h1>References</h1>
<p>Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. https://allisonhorst.github.io/palmerpenguins/</p>
<p>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org.</p>
<p>Wilke CO (2019). Fundamentals of Data Visualization: A Primer on Making Informative and Compelling Figures. Oâ€™Reilly Media. https://clauswilke.com/dataviz/</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../bw/bw-bi.html" class="pagination-link" aria-label="Bivariate Visualization">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bivariate Visualization</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../bw/bw-quad.html" class="pagination-link" aria-label="Quadvariate Visualization">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quadvariate Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb10" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">---</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="an">title:</span><span class="co"> "Trivariate Visualization"</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">  html:</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">    code-fold: true</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">    theme: cosmo</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">    toc: true</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">    number-sections: false</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">---</span></span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="in">knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="in">library(tidyverse)</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="in">library(palmerpenguins)</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="in">library(viridis)</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="in">library(ggrepel)</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="in">library(patchwork)  # For arranging multiple plots</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="in">library(scales)     # For better axis formatting</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="in">```</span></span>
<span id="cb10-20"><a href="#cb10-20"></a></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="fu"># Journey into Multi-Dimensional Data Visualization</span></span>
<span id="cb10-22"><a href="#cb10-22"></a></span>
<span id="cb10-23"><a href="#cb10-23"></a>Imagine standing on the shores of Antarctica, observing penguins in their natural habitat. How would you capture and communicate the complex relationships between their physical characteristics? This is where trivariate visualization comes into playâ€”allowing us to tell richer, more nuanced data stories than would be possible with simpler charts.</span>
<span id="cb10-24"><a href="#cb10-24"></a></span>
<span id="cb10-25"><a href="#cb10-25"></a>While univariate visualizations show us distributions of single variables and bivariate plots reveal relationships between pairs, trivariate visualizations open a window into the complex interplay of three or more variables simultaneously. Our human visual system is remarkably adept at processing multiple visual dimensions, allowing us to encode additional variables through color, size, shape, and transparency.</span>
<span id="cb10-26"><a href="#cb10-26"></a></span>
<span id="cb10-27"><a href="#cb10-27"></a>In this document, we'll embark on a visual exploration of penguin morphology, using the Palmer Penguins dataset as my guide. We'll progress from simple to complex visualizations, demonstrating how thoughtful design can reveal insights that might otherwise remain hidden in the data.</span>
<span id="cb10-28"><a href="#cb10-28"></a></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="fu"># Meeting Our Subjects: The Palmer Penguins</span></span>
<span id="cb10-30"><a href="#cb10-30"></a></span>
<span id="cb10-31"><a href="#cb10-31"></a>Before diving into visualization techniques, let's get acquainted with my subjects. The Palmer Penguins dataset contains measurements from three penguin species living on islands in the Palmer Archipelago, Antarctica. These charming birds provide an excellent case study for exploring multivariate relationships.</span>
<span id="cb10-32"><a href="#cb10-32"></a></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="in">```{r}</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">#| label: penguin-data-exploration</span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co">#| message: false</span></span>
<span id="cb10-38"><a href="#cb10-38"></a><span class="co">#| warning: false</span></span>
<span id="cb10-39"><a href="#cb10-39"></a></span>
<span id="cb10-40"><a href="#cb10-40"></a><span class="co"># Load required libraries</span></span>
<span id="cb10-41"><a href="#cb10-41"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-42"><a href="#cb10-42"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb10-43"><a href="#cb10-43"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb10-44"><a href="#cb10-44"></a></span>
<span id="cb10-45"><a href="#cb10-45"></a><span class="co"># Load the dataset</span></span>
<span id="cb10-46"><a href="#cb10-46"></a><span class="fu">data</span>(penguins)</span>
<span id="cb10-47"><a href="#cb10-47"></a></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="co"># Create a summary table of key statistics by species</span></span>
<span id="cb10-49"><a href="#cb10-49"></a>penguin_summary <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span></span>
<span id="cb10-50"><a href="#cb10-50"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span></span>
<span id="cb10-51"><a href="#cb10-51"></a>  <span class="fu">summarize</span>(</span>
<span id="cb10-52"><a href="#cb10-52"></a>    <span class="st">`</span><span class="at">Count</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>(),</span>
<span id="cb10-53"><a href="#cb10-53"></a>    <span class="st">`</span><span class="at">Bill Length (mm)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb10-54"><a href="#cb10-54"></a>    <span class="st">`</span><span class="at">Bill Depth (mm)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_depth_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb10-55"><a href="#cb10-55"></a>    <span class="st">`</span><span class="at">Flipper Length (mm)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(flipper_length_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb10-56"><a href="#cb10-56"></a>    <span class="st">`</span><span class="at">Body Mass (g)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(body_mass_g, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">0</span>)</span>
<span id="cb10-57"><a href="#cb10-57"></a>  )</span>
<span id="cb10-58"><a href="#cb10-58"></a></span>
<span id="cb10-59"><a href="#cb10-59"></a><span class="co"># Create a nicely formatted table</span></span>
<span id="cb10-60"><a href="#cb10-60"></a>penguin_summary <span class="sc">%&gt;%</span></span>
<span id="cb10-61"><a href="#cb10-61"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Summary Statistics of Penguin Morphology by Species"</span>,</span>
<span id="cb10-62"><a href="#cb10-62"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Species"</span>, <span class="st">"Count"</span>, <span class="st">"Bill Length (mm)"</span>, <span class="st">"Bill Depth (mm)"</span>, </span>
<span id="cb10-63"><a href="#cb10-63"></a>                    <span class="st">"Flipper Length (mm)"</span>, <span class="st">"Body Mass (g)"</span>),</span>
<span id="cb10-64"><a href="#cb10-64"></a>      <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-65"><a href="#cb10-65"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">"Cambria"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-66"><a href="#cb10-66"></a>  <span class="fu">row_spec</span>(<span class="dv">0</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">background =</span> <span class="st">"#264653"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-67"><a href="#cb10-67"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-68"><a href="#cb10-68"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">"Morphological Measurements (Mean Values)"</span> <span class="ot">=</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-69"><a href="#cb10-69"></a>  <span class="fu">footnote</span>(<span class="at">general =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020)"</span>)</span>
<span id="cb10-70"><a href="#cb10-70"></a></span>
<span id="cb10-71"><a href="#cb10-71"></a><span class="co"># Display sample of raw data</span></span>
<span id="cb10-72"><a href="#cb10-72"></a><span class="fu">head</span>(penguins, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-73"><a href="#cb10-73"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Sample of Raw Penguin Data (First 5 Records)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-74"><a href="#cb10-74"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), </span>
<span id="cb10-75"><a href="#cb10-75"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-76"><a href="#cb10-76"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"250px"</span>)</span>
<span id="cb10-77"><a href="#cb10-77"></a><span class="in">```</span></span>
<span id="cb10-78"><a href="#cb10-78"></a></span>
<span id="cb10-79"><a href="#cb10-79"></a>The dataset includes several variables that make it perfect for myy exploration:</span>
<span id="cb10-80"><a href="#cb10-80"></a></span>
<span id="cb10-81"><a href="#cb10-81"></a><span class="ss">- </span>**Morphological measurements**: bill length, bill depth, flipper length, and body mass</span>
<span id="cb10-82"><a href="#cb10-82"></a><span class="ss">- </span>**Categorical variables**: species, island, and sex</span>
<span id="cb10-83"><a href="#cb10-83"></a><span class="ss">- </span>**Temporal data**: year of observation</span>
<span id="cb10-84"><a href="#cb10-84"></a></span>
<span id="cb10-85"><a href="#cb10-85"></a>Each of these variables tells part of a penguin's story, but their true narrative emerges when we examine them in combination. Let's begin our visual storytelling journey.</span>
<span id="cb10-86"><a href="#cb10-86"></a></span>
<span id="cb10-87"><a href="#cb10-87"></a><span class="fu"># The Visual Narrative Unfolds</span></span>
<span id="cb10-88"><a href="#cb10-88"></a></span>
<span id="cb10-89"><a href="#cb10-89"></a><span class="fu">## Chapter 1: Species Differentiation - Nature's Distinct Designs</span></span>
<span id="cb10-90"><a href="#cb10-90"></a></span>
<span id="cb10-91"><a href="#cb10-91"></a>My first visualization explores the fundamental question: How do penguin species differ in their bill morphology? This foundational story establishes the distinct evolutionary paths these species have taken.</span>
<span id="cb10-92"><a href="#cb10-92"></a></span>
<span id="cb10-93"><a href="#cb10-93"></a><span class="in">```{r species-morphology}</span></span>
<span id="cb10-94"><a href="#cb10-94"></a><span class="in"># Trivariate plot with color representing species</span></span>
<span id="cb10-95"><a href="#cb10-95"></a><span class="in">ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +</span></span>
<span id="cb10-96"><a href="#cb10-96"></a><span class="in">  geom_point(size = 3, alpha = 0.8) +</span></span>
<span id="cb10-97"><a href="#cb10-97"></a><span class="in">  scale_color_manual(values = c("Adelie" = "#E64B35", </span></span>
<span id="cb10-98"><a href="#cb10-98"></a><span class="in">                              "Chinstrap" = "#4DBBD5", </span></span>
<span id="cb10-99"><a href="#cb10-99"></a><span class="in">                              "Gentoo" = "#00A087")) +</span></span>
<span id="cb10-100"><a href="#cb10-100"></a><span class="in">  labs(</span></span>
<span id="cb10-101"><a href="#cb10-101"></a><span class="in">    title = "Evolutionary Divergence in Penguin Bill Morphology",</span></span>
<span id="cb10-102"><a href="#cb10-102"></a><span class="in">    subtitle = "Each species occupies a distinct region in the morphological space",</span></span>
<span id="cb10-103"><a href="#cb10-103"></a><span class="in">    x = "Bill Length (mm)",</span></span>
<span id="cb10-104"><a href="#cb10-104"></a><span class="in">    y = "Bill Depth (mm)",</span></span>
<span id="cb10-105"><a href="#cb10-105"></a><span class="in">    color = "Species",</span></span>
<span id="cb10-106"><a href="#cb10-106"></a><span class="in">    caption = "Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb10-107"><a href="#cb10-107"></a><span class="in">  ) +</span></span>
<span id="cb10-108"><a href="#cb10-108"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb10-109"><a href="#cb10-109"></a><span class="in">  theme(</span></span>
<span id="cb10-110"><a href="#cb10-110"></a><span class="in">    plot.title = element_text(face = "bold", size = 14),</span></span>
<span id="cb10-111"><a href="#cb10-111"></a><span class="in">    plot.subtitle = element_text(size = 11, color = "gray30"),</span></span>
<span id="cb10-112"><a href="#cb10-112"></a><span class="in">    legend.position = "right",</span></span>
<span id="cb10-113"><a href="#cb10-113"></a><span class="in">    plot.caption = element_text(size = 9, hjust = 0)</span></span>
<span id="cb10-114"><a href="#cb10-114"></a><span class="in">  ) +</span></span>
<span id="cb10-115"><a href="#cb10-115"></a><span class="in">  # Add explanatory annotations</span></span>
<span id="cb10-116"><a href="#cb10-116"></a><span class="in">  annotate("curve", x = 42, y = 14, xend = 39, yend = 17, </span></span>
<span id="cb10-117"><a href="#cb10-117"></a><span class="in">           curvature = -0.3, arrow = arrow(length = unit(2, "mm")), color = "gray40") +</span></span>
<span id="cb10-118"><a href="#cb10-118"></a><span class="in">  annotate("text", x = 43, y = 13.7, </span></span>
<span id="cb10-119"><a href="#cb10-119"></a><span class="in">           label = "Adelie: Shorter, deeper bills\nadapted for their diet", </span></span>
<span id="cb10-120"><a href="#cb10-120"></a><span class="in">           size = 3, color = "gray20", hjust = 0) +</span></span>
<span id="cb10-121"><a href="#cb10-121"></a><span class="in">  annotate("curve", x = 52, y = 14, xend = 48, yend = 17, </span></span>
<span id="cb10-122"><a href="#cb10-122"></a><span class="in">           curvature = 0.3, arrow = arrow(length = unit(2, "mm")), color = "gray40") +</span></span>
<span id="cb10-123"><a href="#cb10-123"></a><span class="in">  annotate("text", x = 52, y = 13.7, </span></span>
<span id="cb10-124"><a href="#cb10-124"></a><span class="in">           label = "Chinstrap: Longer, narrower bills\nfor specialized feeding", </span></span>
<span id="cb10-125"><a href="#cb10-125"></a><span class="in">           size = 3, color = "gray20", hjust = 0) +</span></span>
<span id="cb10-126"><a href="#cb10-126"></a><span class="in">  annotate("curve", x = 55, y = 15.5, xend = 51, yend = 15, </span></span>
<span id="cb10-127"><a href="#cb10-127"></a><span class="in">           curvature = 0.3, arrow = arrow(length = unit(2, "mm")), color = "gray40") +</span></span>
<span id="cb10-128"><a href="#cb10-128"></a><span class="in">  annotate("text", x = 55, y = 15.5, </span></span>
<span id="cb10-129"><a href="#cb10-129"></a><span class="in">           label = "Gentoo: Longest bills overall\nreflecting different feeding strategy", </span></span>
<span id="cb10-130"><a href="#cb10-130"></a><span class="in">           size = 3, color = "gray20", hjust = 0)</span></span>
<span id="cb10-131"><a href="#cb10-131"></a><span class="in">```</span></span>
<span id="cb10-132"><a href="#cb10-132"></a></span>
<span id="cb10-133"><a href="#cb10-133"></a>This visualization reveals a compelling evolutionary story. Each penguin species has developed a distinct bill morphology, presumably adapted to their specific ecological niches and feeding strategies:</span>
<span id="cb10-134"><a href="#cb10-134"></a></span>
<span id="cb10-135"><a href="#cb10-135"></a><span class="ss">* </span>**Adelie penguins** feature shorter bills with greater depth, possibly evolved for capturing their preferred prey.</span>
<span id="cb10-136"><a href="#cb10-136"></a><span class="ss">* </span>**Chinstrap penguins** display longer, narrower bills, suggesting adaptation to different feeding techniques.</span>
<span id="cb10-137"><a href="#cb10-137"></a><span class="ss">* </span>**Gentoo penguins** have significantly longer bills with moderate depth, reflecting their unique ecological role.</span>
<span id="cb10-138"><a href="#cb10-138"></a></span>
<span id="cb10-139"><a href="#cb10-139"></a>These distinct morphological signatures tell us about the evolutionary pressures that have shaped these species over time.</span>
<span id="cb10-140"><a href="#cb10-140"></a></span>
<span id="cb10-141"><a href="#cb10-141"></a><span class="fu">## Chapter 2: The Size Connection - Integrating Body Mass into My Story</span></span>
<span id="cb10-142"><a href="#cb10-142"></a></span>
<span id="cb10-143"><a href="#cb10-143"></a>Now let's deepen the narrative by incorporating body mass as a fourth dimension. This reveals how bill dimensions relate to overall size, adding another layer to our understanding of penguin morphology.</span>
<span id="cb10-144"><a href="#cb10-144"></a></span>
<span id="cb10-145"><a href="#cb10-145"></a><span class="in">```{r size-relationships}</span></span>
<span id="cb10-146"><a href="#cb10-146"></a><span class="in"># Adding body mass as a fourth variable through point size</span></span>
<span id="cb10-147"><a href="#cb10-147"></a><span class="in">ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, </span></span>
<span id="cb10-148"><a href="#cb10-148"></a><span class="in">                     color = species, size = body_mass_g)) +</span></span>
<span id="cb10-149"><a href="#cb10-149"></a><span class="in">  # Add points with transparency</span></span>
<span id="cb10-150"><a href="#cb10-150"></a><span class="in">  geom_point(alpha = 0.8) +</span></span>
<span id="cb10-151"><a href="#cb10-151"></a><span class="in">  # Use consistent species colors</span></span>
<span id="cb10-152"><a href="#cb10-152"></a><span class="in">  scale_color_manual(values = c("Adelie" = "#E64B35", </span></span>
<span id="cb10-153"><a href="#cb10-153"></a><span class="in">                              "Chinstrap" = "#4DBBD5", </span></span>
<span id="cb10-154"><a href="#cb10-154"></a><span class="in">                              "Gentoo" = "#00A087")) +</span></span>
<span id="cb10-155"><a href="#cb10-155"></a><span class="in">  # Scale size appropriately</span></span>
<span id="cb10-156"><a href="#cb10-156"></a><span class="in">  scale_size_continuous(range = c(1, 8), breaks = seq(3000, 6000, by = 1000)) +</span></span>
<span id="cb10-157"><a href="#cb10-157"></a><span class="in">  # Add statistical ellipses to highlight groupings</span></span>
<span id="cb10-158"><a href="#cb10-158"></a><span class="in">  stat_ellipse(linewidth = 0.7, alpha = 0.2) +</span></span>
<span id="cb10-159"><a href="#cb10-159"></a><span class="in">  # Labels</span></span>
<span id="cb10-160"><a href="#cb10-160"></a><span class="in">  labs(</span></span>
<span id="cb10-161"><a href="#cb10-161"></a><span class="in">    title = "The Complex Interplay of Bill Dimensions and Body Mass",</span></span>
<span id="cb10-162"><a href="#cb10-162"></a><span class="in">    subtitle = "Size patterns reveal evolutionary trade-offs between morphological features",</span></span>
<span id="cb10-163"><a href="#cb10-163"></a><span class="in">    x = "Bill Length (mm)",</span></span>
<span id="cb10-164"><a href="#cb10-164"></a><span class="in">    y = "Bill Depth (mm)",</span></span>
<span id="cb10-165"><a href="#cb10-165"></a><span class="in">    color = "Species",</span></span>
<span id="cb10-166"><a href="#cb10-166"></a><span class="in">    size = "Body Mass (g)",</span></span>
<span id="cb10-167"><a href="#cb10-167"></a><span class="in">    caption = "Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb10-168"><a href="#cb10-168"></a><span class="in">  ) +</span></span>
<span id="cb10-169"><a href="#cb10-169"></a><span class="in">  # Theming</span></span>
<span id="cb10-170"><a href="#cb10-170"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb10-171"><a href="#cb10-171"></a><span class="in">  theme(</span></span>
<span id="cb10-172"><a href="#cb10-172"></a><span class="in">    plot.title = element_text(face = "bold", size = 14),</span></span>
<span id="cb10-173"><a href="#cb10-173"></a><span class="in">    plot.subtitle = element_text(size = 11, color = "gray30"),</span></span>
<span id="cb10-174"><a href="#cb10-174"></a><span class="in">    plot.caption = element_text(size = 9, hjust = 0),</span></span>
<span id="cb10-175"><a href="#cb10-175"></a><span class="in">    legend.position = "right"</span></span>
<span id="cb10-176"><a href="#cb10-176"></a><span class="in">  ) +</span></span>
<span id="cb10-177"><a href="#cb10-177"></a><span class="in">  # Add an annotation explaining the pattern</span></span>
<span id="cb10-178"><a href="#cb10-178"></a><span class="in">  annotate("text", x = 39, y = 21, </span></span>
<span id="cb10-179"><a href="#cb10-179"></a><span class="in">           label = "Note how Gentoo penguins are not only\ndistinct in bill shape but also\nconsistently larger in body mass", </span></span>
<span id="cb10-180"><a href="#cb10-180"></a><span class="in">           size = 3.5, color = "#00A087", fontface = "italic", hjust = 0)</span></span>
<span id="cb10-181"><a href="#cb10-181"></a><span class="in">```</span></span>
<span id="cb10-182"><a href="#cb10-182"></a></span>
<span id="cb10-183"><a href="#cb10-183"></a>As the story unfolds, I discover that Gentoo penguins aren't just different in bill shapeâ€”they're also significantly larger overall. The size variations across species suggest different evolutionary strategies:</span>
<span id="cb10-184"><a href="#cb10-184"></a></span>
<span id="cb10-185"><a href="#cb10-185"></a><span class="ss">* </span>Larger body mass in Gentoo penguins may provide advantages in their particular habitat, perhaps allowing them to dive deeper or survive in colder waters.</span>
<span id="cb10-186"><a href="#cb10-186"></a><span class="ss">* </span>The relationship between bill dimensions and body mass reveals evolutionary trade-offs that each species has navigated.</span>
<span id="cb10-187"><a href="#cb10-187"></a></span>
<span id="cb10-188"><a href="#cb10-188"></a>This visualization begins to paint a picture of penguin evolution as a complex optimization problem, with each species representing a different solution.</span>
<span id="cb10-189"><a href="#cb10-189"></a></span>
<span id="cb10-190"><a href="#cb10-190"></a><span class="fu">## Chapter 3: The Gender Story - Sexual Dimorphism Across Species</span></span>
<span id="cb10-191"><a href="#cb10-191"></a></span>
<span id="cb10-192"><a href="#cb10-192"></a>My narrative now branches to explore another fascinating aspect: how do males and females differ within each species? This chapter in my visual story examines sexual dimorphism, a key component of penguin biology.</span>
<span id="cb10-193"><a href="#cb10-193"></a></span>
<span id="cb10-196"><a href="#cb10-196"></a><span class="in">```{r}</span></span>
<span id="cb10-197"><a href="#cb10-197"></a><span class="co">#| fig.width: 16</span></span>
<span id="cb10-198"><a href="#cb10-198"></a><span class="co">#| fig.height: 12</span></span>
<span id="cb10-199"><a href="#cb10-199"></a><span class="co">#| dpi: 300</span></span>
<span id="cb10-200"><a href="#cb10-200"></a><span class="co"># Visualization</span></span>
<span id="cb10-201"><a href="#cb10-201"></a><span class="fu">ggplot</span>(<span class="fu">na.omit</span>(penguins), <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb10-202"><a href="#cb10-202"></a>  <span class="co"># Add a subtle point jitter with more space</span></span>
<span id="cb10-203"><a href="#cb10-203"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.6</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb10-204"><a href="#cb10-204"></a>  <span class="co"># Add faceting by sex</span></span>
<span id="cb10-205"><a href="#cb10-205"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sex, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-206"><a href="#cb10-206"></a>  <span class="co"># Use consistent species colors</span></span>
<span id="cb10-207"><a href="#cb10-207"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb10-208"><a href="#cb10-208"></a>                               <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb10-209"><a href="#cb10-209"></a>                               <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>)) <span class="sc">+</span></span>
<span id="cb10-210"><a href="#cb10-210"></a>  <span class="co"># Add mean points with larger size and thicker border</span></span>
<span id="cb10-211"><a href="#cb10-211"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb10-212"><a href="#cb10-212"></a>               <span class="fu">aes</span>(<span class="at">fill =</span> species), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"grey70"</span>, <span class="at">stroke =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-213"><a href="#cb10-213"></a>  <span class="co"># Use same colors for fill</span></span>
<span id="cb10-214"><a href="#cb10-214"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span> <span class="ot">=</span> <span class="st">"#E64B35"</span>, </span>
<span id="cb10-215"><a href="#cb10-215"></a>                              <span class="st">"Chinstrap"</span> <span class="ot">=</span> <span class="st">"#4DBBD5"</span>, </span>
<span id="cb10-216"><a href="#cb10-216"></a>                              <span class="st">"Gentoo"</span> <span class="ot">=</span> <span class="st">"#00A087"</span>),</span>
<span id="cb10-217"><a href="#cb10-217"></a>                   <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb10-218"><a href="#cb10-218"></a>  <span class="co"># Labels</span></span>
<span id="cb10-219"><a href="#cb10-219"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-220"><a href="#cb10-220"></a>    <span class="at">title =</span> <span class="st">"The Two Sides of Penguin Evolution: Male and Female Morphology"</span>,</span>
<span id="cb10-221"><a href="#cb10-221"></a>    <span class="at">subtitle =</span> <span class="st">"Sexual dimorphism reveals different selection pressures across species"</span>,</span>
<span id="cb10-222"><a href="#cb10-222"></a>    <span class="at">x =</span> <span class="st">"Bill Length (mm)"</span>,</span>
<span id="cb10-223"><a href="#cb10-223"></a>    <span class="at">y =</span> <span class="st">"Bill Depth (mm)"</span>,</span>
<span id="cb10-224"><a href="#cb10-224"></a>    <span class="at">color =</span> <span class="st">"Species"</span>,</span>
<span id="cb10-225"><a href="#cb10-225"></a>    <span class="at">caption =</span> <span class="st">"Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb10-226"><a href="#cb10-226"></a>  ) <span class="sc">+</span></span>
<span id="cb10-227"><a href="#cb10-227"></a>  <span class="co"># positioned legend elements</span></span>
<span id="cb10-228"><a href="#cb10-228"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">50</span>, <span class="at">y =</span> <span class="fl">13.5</span>, </span>
<span id="cb10-229"><a href="#cb10-229"></a>           <span class="at">label =</span> <span class="st">"Notice: The degree of sexual dimorphism varies by species,</span><span class="sc">\n</span><span class="st">suggesting different mating strategies and selection pressures"</span>, </span>
<span id="cb10-230"><a href="#cb10-230"></a>           <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"grey20"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-231"><a href="#cb10-231"></a>  <span class="co">#  theme</span></span>
<span id="cb10-232"><a href="#cb10-232"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-233"><a href="#cb10-233"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-234"><a href="#cb10-234"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"sans"</span>, <span class="at">color =</span> <span class="st">"grey20"</span>),</span>
<span id="cb10-235"><a href="#cb10-235"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb10-236"><a href="#cb10-236"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb10-237"><a href="#cb10-237"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray95"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb10-238"><a href="#cb10-238"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb10-239"><a href="#cb10-239"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb10-240"><a href="#cb10-240"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb10-241"><a href="#cb10-241"></a>  ) <span class="sc">+</span></span>
<span id="cb10-242"><a href="#cb10-242"></a>  <span class="co"># Add a custom legend for point types</span></span>
<span id="cb10-243"><a href="#cb10-243"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">38</span>, <span class="at">y =</span> <span class="fl">14.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#E64B35"</span>) <span class="sc">+</span></span>
<span id="cb10-244"><a href="#cb10-244"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">39.5</span>, <span class="at">y =</span> <span class="fl">14.5</span>, <span class="at">label =</span> <span class="st">"Individual penguins"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-245"><a href="#cb10-245"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">38</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="at">size =</span> <span class="dv">6</span>, <span class="at">shape =</span> <span class="dv">21</span>, </span>
<span id="cb10-246"><a href="#cb10-246"></a>           <span class="at">fill =</span> <span class="st">"#E64B35"</span>, <span class="at">color =</span> <span class="st">"grey60"</span>, <span class="at">stroke =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-247"><a href="#cb10-247"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">39.5</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="at">label =</span> <span class="st">"Species means"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb10-248"><a href="#cb10-248"></a><span class="in">```</span></span>
<span id="cb10-249"><a href="#cb10-249"></a></span>
<span id="cb10-250"><a href="#cb10-250"></a></span>
<span id="cb10-251"><a href="#cb10-251"></a>The story of sexual dimorphism adds another fascinating layer to our understanding. While male penguins generally have larger bills than females across all species, the degree of dimorphism varies:</span>
<span id="cb10-252"><a href="#cb10-252"></a></span>
<span id="cb10-253"><a href="#cb10-253"></a><span class="ss">* </span>The pronounced differences between males and females reflect sexual selection pressures and different reproductive roles.</span>
<span id="cb10-254"><a href="#cb10-254"></a><span class="ss">* </span>The varying degree of dimorphism across species suggests different mating systems or environmental constraints.</span>
<span id="cb10-255"><a href="#cb10-255"></a><span class="ss">* </span>The larger bills in males might be advantageous during courtship, territory defense, or providing for offspring.</span>
<span id="cb10-256"><a href="#cb10-256"></a></span>
<span id="cb10-257"><a href="#cb10-257"></a>This chapter in our visual narrative reveals how evolution has shaped not just species differences, but also differences between sexes within each species.</span>
<span id="cb10-258"><a href="#cb10-258"></a></span>
<span id="cb10-259"><a href="#cb10-259"></a><span class="fu">## Chapter 4: The Complete Portrait - Five Dimensions in One View</span></span>
<span id="cb10-260"><a href="#cb10-260"></a></span>
<span id="cb10-261"><a href="#cb10-261"></a>Now we'll integrate multiple aspects of penguin morphology into a comprehensive visualization that tells a more complete story, incorporating flipper length, body mass, species, sex, and bill length all at once.</span>
<span id="cb10-262"><a href="#cb10-262"></a></span>
<span id="cb10-263"><a href="#cb10-263"></a><span class="in">```{r comprehensive-morphology}</span></span>
<span id="cb10-264"><a href="#cb10-264"></a><span class="in">#| fig.width: 16</span></span>
<span id="cb10-265"><a href="#cb10-265"></a><span class="in">#| fig.height: 12</span></span>
<span id="cb10-266"><a href="#cb10-266"></a><span class="in">#| dpi: 300</span></span>
<span id="cb10-267"><a href="#cb10-267"></a><span class="in"># Improved multi-variable visualization</span></span>
<span id="cb10-268"><a href="#cb10-268"></a><span class="in">ggplot(na.omit(penguins), </span></span>
<span id="cb10-269"><a href="#cb10-269"></a><span class="in">       aes(x = flipper_length_mm, y = body_mass_g, </span></span>
<span id="cb10-270"><a href="#cb10-270"></a><span class="in">           color = species, shape = sex, size = bill_length_mm)) +</span></span>
<span id="cb10-271"><a href="#cb10-271"></a><span class="in">  # Add a subtle grid to aid in reading values</span></span>
<span id="cb10-272"><a href="#cb10-272"></a><span class="in">  geom_hline(yintercept = seq(3000, 6000, by = 500), color = "gray95", linewidth = 0.5) +</span></span>
<span id="cb10-273"><a href="#cb10-273"></a><span class="in">  geom_vline(xintercept = seq(180, 230, by = 10), color = "gray95", linewidth = 0.5) +</span></span>
<span id="cb10-274"><a href="#cb10-274"></a><span class="in">  # Plot points</span></span>
<span id="cb10-275"><a href="#cb10-275"></a><span class="in">  geom_point(alpha = 0.9) +</span></span>
<span id="cb10-276"><a href="#cb10-276"></a><span class="in">  # Consistent color palette</span></span>
<span id="cb10-277"><a href="#cb10-277"></a><span class="in">  scale_color_manual(values = c("Adelie" = "#E64B35", </span></span>
<span id="cb10-278"><a href="#cb10-278"></a><span class="in">                               "Chinstrap" = "#4DBBD5", </span></span>
<span id="cb10-279"><a href="#cb10-279"></a><span class="in">                               "Gentoo" = "#00A087")) +</span></span>
<span id="cb10-280"><a href="#cb10-280"></a><span class="in">  scale_size_continuous(range = c(1.5, 7)) +</span></span>
<span id="cb10-281"><a href="#cb10-281"></a><span class="in">  # Format the y-axis with comma separators</span></span>
<span id="cb10-282"><a href="#cb10-282"></a><span class="in">  scale_y_continuous(labels = comma) +</span></span>
<span id="cb10-283"><a href="#cb10-283"></a><span class="in">  # Better shape scale</span></span>
<span id="cb10-284"><a href="#cb10-284"></a><span class="in">  scale_shape_manual(values = c(16, 17)) +</span></span>
<span id="cb10-285"><a href="#cb10-285"></a><span class="in">  # Labels</span></span>
<span id="cb10-286"><a href="#cb10-286"></a><span class="in">  labs(</span></span>
<span id="cb10-287"><a href="#cb10-287"></a><span class="in">    title = "The Complete Penguin Portrait: A Five-Dimensional View",</span></span>
<span id="cb10-288"><a href="#cb10-288"></a><span class="in">    subtitle = "Revealing the interconnected nature of morphological adaptations",</span></span>
<span id="cb10-289"><a href="#cb10-289"></a><span class="in">    x = "Flipper Length (mm)",</span></span>
<span id="cb10-290"><a href="#cb10-290"></a><span class="in">    y = "Body Mass (g)",</span></span>
<span id="cb10-291"><a href="#cb10-291"></a><span class="in">    color = "Species",</span></span>
<span id="cb10-292"><a href="#cb10-292"></a><span class="in">    shape = "Sex",</span></span>
<span id="cb10-293"><a href="#cb10-293"></a><span class="in">    size = "Bill Length (mm)",</span></span>
<span id="cb10-294"><a href="#cb10-294"></a><span class="in">    caption = "Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb10-295"><a href="#cb10-295"></a><span class="in">  ) +</span></span>
<span id="cb10-296"><a href="#cb10-296"></a><span class="in">  # Add annotations highlighting key patterns</span></span>
<span id="cb10-297"><a href="#cb10-297"></a><span class="in">  annotate("text", x = 190, y = 5800, </span></span>
<span id="cb10-298"><a href="#cb10-298"></a><span class="in">           label = "Gentoo penguins form a distinct cluster,\nsuggesting coordinated evolution of multiple traits", </span></span>
<span id="cb10-299"><a href="#cb10-299"></a><span class="in">           size = 3, color = "grey20", hjust = 0) +</span></span>
<span id="cb10-300"><a href="#cb10-300"></a><span class="in">  annotate("curve", x = 190, y = 5700, xend = 210, yend = 5500, </span></span>
<span id="cb10-301"><a href="#cb10-301"></a><span class="in">           curvature = -0.2, arrow = arrow(length = unit(2, "mm")), color = "grey40") +</span></span>
<span id="cb10-302"><a href="#cb10-302"></a><span class="in">  # Theme adjustments</span></span>
<span id="cb10-303"><a href="#cb10-303"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb10-304"><a href="#cb10-304"></a><span class="in">  theme(</span></span>
<span id="cb10-305"><a href="#cb10-305"></a><span class="in">    legend.position = "right",</span></span>
<span id="cb10-306"><a href="#cb10-306"></a><span class="in">    plot.title = element_text(face = "bold"),</span></span>
<span id="cb10-307"><a href="#cb10-307"></a><span class="in">    plot.subtitle = element_text(size = 10, color = "gray30"),</span></span>
<span id="cb10-308"><a href="#cb10-308"></a><span class="in">    plot.caption = element_text(size = 9, hjust = 0),</span></span>
<span id="cb10-309"><a href="#cb10-309"></a><span class="in">    panel.grid = element_blank()  # Remove default grid in favor of custom grid</span></span>
<span id="cb10-310"><a href="#cb10-310"></a><span class="in">  )</span></span>
<span id="cb10-311"><a href="#cb10-311"></a><span class="in">```</span></span>
<span id="cb10-312"><a href="#cb10-312"></a></span>
<span id="cb10-313"><a href="#cb10-313"></a>This comprehensive visualization integrates five different variables into a single coherent story, revealing how multiple morphological features evolve together:</span>
<span id="cb10-314"><a href="#cb10-314"></a></span>
<span id="cb10-315"><a href="#cb10-315"></a><span class="ss">* </span>Flipper length and body mass show strong positive correlation within species.</span>
<span id="cb10-316"><a href="#cb10-316"></a><span class="ss">* </span>Males (triangles) and females (circles) form distinct clusters within each species.</span>
<span id="cb10-317"><a href="#cb10-317"></a><span class="ss">* </span>Bill length (represented by point size) increases along with body mass and flipper length.</span>
<span id="cb10-318"><a href="#cb10-318"></a><span class="ss">* </span>Gentoo penguins form a completely separated cluster, highlighting their evolutionary divergence.</span>
<span id="cb10-319"><a href="#cb10-319"></a></span>
<span id="cb10-320"><a href="#cb10-320"></a>This multi-dimensional view suggests that penguin morphology evolved as an integrated system rather than as individual traits, with natural selection operating on the entire morphological package.</span>
<span id="cb10-321"><a href="#cb10-321"></a></span>
<span id="cb10-322"><a href="#cb10-322"></a><span class="fu">## Chapter 5: The Statistical Narrative - Quantifying Relationships</span></span>
<span id="cb10-323"><a href="#cb10-323"></a></span>
<span id="cb10-324"><a href="#cb10-324"></a>Let's add a statistical layer to our story, highlighting the strength of relationships between different morphological features across species.</span>
<span id="cb10-325"><a href="#cb10-325"></a></span>
<span id="cb10-326"><a href="#cb10-326"></a><span class="in">```{r statistical-relationships}</span></span>
<span id="cb10-327"><a href="#cb10-327"></a><span class="in">#| fig.width: 10</span></span>
<span id="cb10-328"><a href="#cb10-328"></a><span class="in">#| fig.height: 8</span></span>
<span id="cb10-329"><a href="#cb10-329"></a><span class="in">#| dpi: 300</span></span>
<span id="cb10-330"><a href="#cb10-330"></a><span class="in"># Enhanced statistical visualization</span></span>
<span id="cb10-331"><a href="#cb10-331"></a><span class="in">ggplot(penguins, aes(x = bill_length_mm, y = flipper_length_mm, color = species)) +</span></span>
<span id="cb10-332"><a href="#cb10-332"></a><span class="in">  # Add custom gridlines</span></span>
<span id="cb10-333"><a href="#cb10-333"></a><span class="in">  geom_hline(yintercept = seq(180, 230, by = 10), color = "gray95", linewidth = 0.5) +</span></span>
<span id="cb10-334"><a href="#cb10-334"></a><span class="in">  geom_vline(xintercept = seq(30, 60, by = 5), color = "gray95", linewidth = 0.5) +</span></span>
<span id="cb10-335"><a href="#cb10-335"></a><span class="in">  # Add points</span></span>
<span id="cb10-336"><a href="#cb10-336"></a><span class="in">  geom_point(alpha = 0.7) +</span></span>
<span id="cb10-337"><a href="#cb10-337"></a><span class="in">  # Add statistical elements</span></span>
<span id="cb10-338"><a href="#cb10-338"></a><span class="in">  geom_smooth(method = "lm", se = TRUE, alpha = 0.2, linewidth = 1) +</span></span>
<span id="cb10-339"><a href="#cb10-339"></a><span class="in">  stat_ellipse(level = 0.95, linetype = 2, linewidth = 0.8) +</span></span>
<span id="cb10-340"><a href="#cb10-340"></a><span class="in">  # Use consistent color scheme</span></span>
<span id="cb10-341"><a href="#cb10-341"></a><span class="in">  scale_color_manual(values = c("Adelie" = "#E64B35", </span></span>
<span id="cb10-342"><a href="#cb10-342"></a><span class="in">                              "Chinstrap" = "#4DBBD5", </span></span>
<span id="cb10-343"><a href="#cb10-343"></a><span class="in">                              "Gentoo" = "#00A087")) +</span></span>
<span id="cb10-344"><a href="#cb10-344"></a><span class="in">  # Add axis labels</span></span>
<span id="cb10-345"><a href="#cb10-345"></a><span class="in">  labs(</span></span>
<span id="cb10-346"><a href="#cb10-346"></a><span class="in">    title = "The Mathematical Signature of Evolution",</span></span>
<span id="cb10-347"><a href="#cb10-347"></a><span class="in">    subtitle = "Quantifying the relationship between bill length and flipper length",</span></span>
<span id="cb10-348"><a href="#cb10-348"></a><span class="in">    x = "Bill Length (mm)",</span></span>
<span id="cb10-349"><a href="#cb10-349"></a><span class="in">    y = "Flipper Length (mm)",</span></span>
<span id="cb10-350"><a href="#cb10-350"></a><span class="in">    color = "Species",</span></span>
<span id="cb10-351"><a href="#cb10-351"></a><span class="in">    caption = "Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb10-352"><a href="#cb10-352"></a><span class="in">  ) +</span></span>
<span id="cb10-353"><a href="#cb10-353"></a><span class="in">  # Improve theme</span></span>
<span id="cb10-354"><a href="#cb10-354"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb10-355"><a href="#cb10-355"></a><span class="in">  theme(</span></span>
<span id="cb10-356"><a href="#cb10-356"></a><span class="in">    plot.title = element_text(face = "bold"),</span></span>
<span id="cb10-357"><a href="#cb10-357"></a><span class="in">    plot.caption = element_text(size = 9, hjust = 0),</span></span>
<span id="cb10-358"><a href="#cb10-358"></a><span class="in">    legend.position = c(0.15, 0.85),</span></span>
<span id="cb10-359"><a href="#cb10-359"></a><span class="in">    legend.background = element_rect(fill = "white", color = NA),</span></span>
<span id="cb10-360"><a href="#cb10-360"></a><span class="in">    panel.grid = element_blank()  # Remove default grid</span></span>
<span id="cb10-361"><a href="#cb10-361"></a><span class="in">  ) +</span></span>
<span id="cb10-362"><a href="#cb10-362"></a><span class="in">  # Add correlation annotations</span></span>
<span id="cb10-363"><a href="#cb10-363"></a><span class="in">  annotate("text", x = 35, y = 225, </span></span>
<span id="cb10-364"><a href="#cb10-364"></a><span class="in">           label = "Gentoo: r = 0.71\nStrongest correlation suggests\ntighter evolutionary constraints", </span></span>
<span id="cb10-365"><a href="#cb10-365"></a><span class="in">           size = 3, color = "#00A087", hjust = 0, fontface = "italic") +</span></span>
<span id="cb10-366"><a href="#cb10-366"></a><span class="in">  annotate("text", x = 35, y = 215, </span></span>
<span id="cb10-367"><a href="#cb10-367"></a><span class="in">           label = "Chinstrap: r = 0.63\nModerate correlation indicates\nbalanced selection pressures", </span></span>
<span id="cb10-368"><a href="#cb10-368"></a><span class="in">           size = 3, color = "#4DBBD5", hjust = 0, fontface = "italic") +</span></span>
<span id="cb10-369"><a href="#cb10-369"></a><span class="in">  annotate("text", x = 35, y = 205, </span></span>
<span id="cb10-370"><a href="#cb10-370"></a><span class="in">           label = "Adelie: r = 0.41\nWeaker correlation suggests more\nindependent trait evolution", </span></span>
<span id="cb10-371"><a href="#cb10-371"></a><span class="in">           size = 3, color = "#E64B35", hjust = 0, fontface = "italic")</span></span>
<span id="cb10-372"><a href="#cb10-372"></a><span class="in">```</span></span>
<span id="cb10-373"><a href="#cb10-373"></a></span>
<span id="cb10-374"><a href="#cb10-374"></a>This statistical chapter in our story provides a mathematical perspective on penguin evolution:</span>
<span id="cb10-375"><a href="#cb10-375"></a></span>
<span id="cb10-376"><a href="#cb10-376"></a><span class="ss">* </span>The correlation coefficients quantify the strength of the relationship between bill length and flipper length.</span>
<span id="cb10-377"><a href="#cb10-377"></a><span class="ss">* </span>Gentoo penguins show the strongest correlation (r = 0.71), suggesting their traits evolved under tighter constraints or stronger directional selection.</span>
<span id="cb10-378"><a href="#cb10-378"></a><span class="ss">* </span>Adelie penguins show the weakest correlation (r = 0.41), suggesting more flexibility in how these traits evolved.</span>
<span id="cb10-379"><a href="#cb10-379"></a><span class="ss">* </span>The confidence ellipses provide a visual representation of the variability within each species.</span>
<span id="cb10-380"><a href="#cb10-380"></a></span>
<span id="cb10-381"><a href="#cb10-381"></a>These statistical patterns give us insight into the different evolutionary forces that have shaped each species.</span>
<span id="cb10-382"><a href="#cb10-382"></a></span>
<span id="cb10-383"><a href="#cb10-383"></a><span class="fu">## Chapter 6: The Extremes - Highlighting Notable Specimens</span></span>
<span id="cb10-384"><a href="#cb10-384"></a></span>
<span id="cb10-385"><a href="#cb10-385"></a>Our story now turns to individual penguins with extreme characteristics, exploring the boundaries of morphological variation.</span>
<span id="cb10-386"><a href="#cb10-386"></a></span>
<span id="cb10-387"><a href="#cb10-387"></a><span class="in">```{r notable-specimens}</span></span>
<span id="cb10-388"><a href="#cb10-388"></a><span class="in">#| fig.width: 10</span></span>
<span id="cb10-389"><a href="#cb10-389"></a><span class="in">#| fig.height: 8</span></span>
<span id="cb10-390"><a href="#cb10-390"></a><span class="in">#| dpi: 300</span></span>
<span id="cb10-391"><a href="#cb10-391"></a><span class="in"># Calculate species means for comparison</span></span>
<span id="cb10-392"><a href="#cb10-392"></a><span class="in">species_means &lt;- penguins %&gt;%</span></span>
<span id="cb10-393"><a href="#cb10-393"></a><span class="in">  group_by(species) %&gt;%</span></span>
<span id="cb10-394"><a href="#cb10-394"></a><span class="in">  summarize(</span></span>
<span id="cb10-395"><a href="#cb10-395"></a><span class="in">    mean_bill_length = mean(bill_length_mm, na.rm = TRUE),</span></span>
<span id="cb10-396"><a href="#cb10-396"></a><span class="in">    mean_bill_depth = mean(bill_depth_mm, na.rm = TRUE)</span></span>
<span id="cb10-397"><a href="#cb10-397"></a><span class="in">  )</span></span>
<span id="cb10-398"><a href="#cb10-398"></a></span>
<span id="cb10-399"><a href="#cb10-399"></a><span class="in"># Identify interesting points for annotation</span></span>
<span id="cb10-400"><a href="#cb10-400"></a><span class="in">interesting_points &lt;- penguins %&gt;%</span></span>
<span id="cb10-401"><a href="#cb10-401"></a><span class="in">  group_by(species) %&gt;%</span></span>
<span id="cb10-402"><a href="#cb10-402"></a><span class="in">  filter(bill_length_mm == max(bill_length_mm, na.rm = TRUE) | </span></span>
<span id="cb10-403"><a href="#cb10-403"></a><span class="in">         bill_depth_mm == max(bill_depth_mm, na.rm = TRUE)) %&gt;%</span></span>
<span id="cb10-404"><a href="#cb10-404"></a><span class="in">  distinct(species, .keep_all = TRUE)</span></span>
<span id="cb10-405"><a href="#cb10-405"></a></span>
<span id="cb10-406"><a href="#cb10-406"></a><span class="in"># Create an improved annotated visualization</span></span>
<span id="cb10-407"><a href="#cb10-407"></a><span class="in">ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, color = species)) +</span></span>
<span id="cb10-408"><a href="#cb10-408"></a><span class="in">  # Add subtle background elements</span></span>
<span id="cb10-409"><a href="#cb10-409"></a><span class="in">  geom_hline(yintercept = species_means$mean_bill_depth, color = "gray90", </span></span>
<span id="cb10-410"><a href="#cb10-410"></a><span class="in">             linetype = "dashed") +</span></span>
<span id="cb10-411"><a href="#cb10-411"></a><span class="in">  geom_vline(xintercept = species_means$mean_bill_length, color = "gray90", </span></span>
<span id="cb10-412"><a href="#cb10-412"></a><span class="in">             linetype = "dashed") +</span></span>
<span id="cb10-413"><a href="#cb10-413"></a><span class="in">  # Add points</span></span>
<span id="cb10-414"><a href="#cb10-414"></a><span class="in">  geom_point(alpha = 0.5) +</span></span>
<span id="cb10-415"><a href="#cb10-415"></a><span class="in">  # Highlight interesting points</span></span>
<span id="cb10-416"><a href="#cb10-416"></a><span class="in">  geom_point(data = interesting_points, size = 4, shape = 21, </span></span>
<span id="cb10-417"><a href="#cb10-417"></a><span class="in">             fill = "white", stroke = 1.5) +</span></span>
<span id="cb10-418"><a href="#cb10-418"></a><span class="in">  # Add annotations</span></span>
<span id="cb10-419"><a href="#cb10-419"></a><span class="in">  geom_text_repel(</span></span>
<span id="cb10-420"><a href="#cb10-420"></a><span class="in">    data = interesting_points,</span></span>
<span id="cb10-421"><a href="#cb10-421"></a><span class="in">    aes(label = paste0("Max ", species, "\n", "Island: ", island, "\n", "Sex: ", sex)),</span></span>
<span id="cb10-422"><a href="#cb10-422"></a><span class="in">    box.padding = 0.5,</span></span>
<span id="cb10-423"><a href="#cb10-423"></a><span class="in">    point.padding = 0.5,</span></span>
<span id="cb10-424"><a href="#cb10-424"></a><span class="in">    force = 2,</span></span>
<span id="cb10-425"><a href="#cb10-425"></a><span class="in">    segment.color = "gray50",</span></span>
<span id="cb10-426"><a href="#cb10-426"></a><span class="in">    size = 3.5</span></span>
<span id="cb10-427"><a href="#cb10-427"></a><span class="in">  ) +</span></span>
<span id="cb10-428"><a href="#cb10-428"></a><span class="in">  # Consistent color scheme</span></span>
<span id="cb10-429"><a href="#cb10-429"></a><span class="in">  scale_color_manual(values = c("Adelie" = "#E64B35", </span></span>
<span id="cb10-430"><a href="#cb10-430"></a><span class="in">                              "Chinstrap" = "#4DBBD5", </span></span>
<span id="cb10-431"><a href="#cb10-431"></a><span class="in">                              "Gentoo" = "#00A087")) +</span></span>
<span id="cb10-432"><a href="#cb10-432"></a><span class="in">  # Add labels</span></span>
<span id="cb10-433"><a href="#cb10-433"></a><span class="in">  labs(</span></span>
<span id="cb10-434"><a href="#cb10-434"></a><span class="in">    title = "Living on the Edge: Extreme Morphology in Penguin Populations",</span></span>
<span id="cb10-435"><a href="#cb10-435"></a><span class="in">    subtitle = "Examining penguins with maximum bill dimensions reveals morphological boundaries",</span></span>
<span id="cb10-436"><a href="#cb10-436"></a><span class="in">    x = "Bill Length (mm)",</span></span>
<span id="cb10-437"><a href="#cb10-437"></a><span class="in">    y = "Bill Depth (mm)",</span></span>
<span id="cb10-438"><a href="#cb10-438"></a><span class="in">    color = "Species",</span></span>
<span id="cb10-439"><a href="#cb10-439"></a><span class="in">    caption = "Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb10-440"><a href="#cb10-440"></a><span class="in">  ) +</span></span>
<span id="cb10-441"><a href="#cb10-441"></a><span class="in">  # Improve theme</span></span>
<span id="cb10-442"><a href="#cb10-442"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb10-443"><a href="#cb10-443"></a><span class="in">  theme(</span></span>
<span id="cb10-444"><a href="#cb10-444"></a><span class="in">    plot.title = element_text(face = "bold"),</span></span>
<span id="cb10-445"><a href="#cb10-445"></a><span class="in">    plot.caption = element_text(size = 9, hjust = 0),</span></span>
<span id="cb10-446"><a href="#cb10-446"></a><span class="in">    legend.position = "bottom",</span></span>
<span id="cb10-447"><a href="#cb10-447"></a><span class="in">    panel.grid = element_blank()  # Remove default grid</span></span>
<span id="cb10-448"><a href="#cb10-448"></a><span class="in">  ) +</span></span>
<span id="cb10-449"><a href="#cb10-449"></a><span class="in">  # Add an explanatory annotation</span></span>
<span id="cb10-450"><a href="#cb10-450"></a><span class="in">  annotate("text", x = 37, y = 14, </span></span>
<span id="cb10-451"><a href="#cb10-451"></a><span class="in">           label = "Dashed lines represent species means.\nExtreme individuals may represent the\nfrontier of evolutionary adaptation.", </span></span>
<span id="cb10-452"><a href="#cb10-452"></a><span class="in">           size = 3, color = "grey20", hjust = 0)</span></span>
<span id="cb10-453"><a href="#cb10-453"></a><span class="in">```</span></span>
<span id="cb10-454"><a href="#cb10-454"></a></span>
<span id="cb10-455"><a href="#cb10-455"></a>This chapter focuses on extreme individuals, the outliers of penguin morphology:</span>
<span id="cb10-456"><a href="#cb10-456"></a></span>
<span id="cb10-457"><a href="#cb10-457"></a><span class="ss">* </span>These specimens represent the boundaries of what's possible within each species' morphological space.</span>
<span id="cb10-458"><a href="#cb10-458"></a><span class="ss">* </span>The maximum bill dimensions might indicate the upper limits of beneficial adaptation.</span>
<span id="cb10-459"><a href="#cb10-459"></a><span class="ss">* </span>The dashed lines representing species means provide context for just how extreme these individuals are.</span>
<span id="cb10-460"><a href="#cb10-460"></a><span class="ss">* </span>Interestingly, these extreme specimens come from different islands and include both males and females.</span>
<span id="cb10-461"><a href="#cb10-461"></a></span>
<span id="cb10-462"><a href="#cb10-462"></a>Examining these outliers gives us insight into the range of morphological variation that can still be viable within a species.</span>
<span id="cb10-463"><a href="#cb10-463"></a></span>
<span id="cb10-464"><a href="#cb10-464"></a><span class="fu">## Chapter 7: The Geographic Story - Distributions Across Islands</span></span>
<span id="cb10-465"><a href="#cb10-465"></a></span>
<span id="cb10-466"><a href="#cb10-466"></a>Our final chapter explores how penguin morphology varies across different geographic locations, adding a spatial dimension to our narrative.</span>
<span id="cb10-467"><a href="#cb10-467"></a></span>
<span id="cb10-468"><a href="#cb10-468"></a><span class="in">```{r geographic-variation}</span></span>
<span id="cb10-469"><a href="#cb10-469"></a><span class="in">#| fig.width: 8</span></span>
<span id="cb10-470"><a href="#cb10-470"></a><span class="in">#| fig.height: 6</span></span>
<span id="cb10-471"><a href="#cb10-471"></a><span class="in">#| dpi: 300</span></span>
<span id="cb10-472"><a href="#cb10-472"></a><span class="in"># Create a new visualization showing distribution across islands</span></span>
<span id="cb10-473"><a href="#cb10-473"></a><span class="in">ggplot(na.omit(penguins), </span></span>
<span id="cb10-474"><a href="#cb10-474"></a><span class="in">       aes(x = island, y = body_mass_g, fill = species)) +</span></span>
<span id="cb10-475"><a href="#cb10-475"></a><span class="in">  # Create violin plots to show distribution</span></span>
<span id="cb10-476"><a href="#cb10-476"></a><span class="in">  geom_violin(alpha = 0.7) +</span></span>
<span id="cb10-477"><a href="#cb10-477"></a><span class="in">  # Add jittered points</span></span>
<span id="cb10-478"><a href="#cb10-478"></a><span class="in">  geom_jitter(width = 0.2, alpha = 0.6, aes(color = species)) +</span></span>
<span id="cb10-479"><a href="#cb10-479"></a><span class="in">  # Add mean points</span></span>
<span id="cb10-480"><a href="#cb10-480"></a><span class="in">  stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "white") +</span></span>
<span id="cb10-481"><a href="#cb10-481"></a><span class="in">  # Consistent color scheme</span></span>
<span id="cb10-482"><a href="#cb10-482"></a><span class="in">  scale_fill_manual(values = c("Adelie" = "#E64B35", </span></span>
<span id="cb10-483"><a href="#cb10-483"></a><span class="in">                              "Chinstrap" = "#4DBBD5", </span></span>
<span id="cb10-484"><a href="#cb10-484"></a><span class="in">                              "Gentoo" = "#00A087")) +</span></span>
<span id="cb10-485"><a href="#cb10-485"></a><span class="in">  scale_color_manual(values = c("Adelie" = "#E64B35", </span></span>
<span id="cb10-486"><a href="#cb10-486"></a><span class="in">                              "Chinstrap" = "#4DBBD5", </span></span>
<span id="cb10-487"><a href="#cb10-487"></a><span class="in">                              "Gentoo" = "#00A087")) +</span></span>
<span id="cb10-488"><a href="#cb10-488"></a><span class="in">  # Format y-axis</span></span>
<span id="cb10-489"><a href="#cb10-489"></a><span class="in">  scale_y_continuous(labels = comma) +</span></span>
<span id="cb10-490"><a href="#cb10-490"></a><span class="in">  # Add labels</span></span>
<span id="cb10-491"><a href="#cb10-491"></a><span class="in">  labs(</span></span>
<span id="cb10-492"><a href="#cb10-492"></a><span class="in">    title = "The Geography of Penguin Evolution",</span></span>
<span id="cb10-493"><a href="#cb10-493"></a><span class="in">    subtitle = "How body mass distributions vary across different islands in the Palmer Archipelago",</span></span>
<span id="cb10-494"><a href="#cb10-494"></a><span class="in">    x = "Island",</span></span>
<span id="cb10-495"><a href="#cb10-495"></a><span class="in">    y = "Body Mass (g)",</span></span>
<span id="cb10-496"><a href="#cb10-496"></a><span class="in">    fill = "Species",</span></span>
<span id="cb10-497"><a href="#cb10-497"></a><span class="in">    color = "Species",</span></span>
<span id="cb10-498"><a href="#cb10-498"></a><span class="in">    caption = "Data source: Palmer Penguins dataset (Horst, Hill, &amp; Gorman, 2020) | Created by Zhijun He"</span></span>
<span id="cb10-499"><a href="#cb10-499"></a><span class="in">  ) +</span></span>
<span id="cb10-500"><a href="#cb10-500"></a><span class="in">  # Improve theme</span></span>
<span id="cb10-501"><a href="#cb10-501"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb10-502"><a href="#cb10-502"></a><span class="in">  theme(</span></span>
<span id="cb10-503"><a href="#cb10-503"></a><span class="in">    plot.title = element_text(face = "bold"),</span></span>
<span id="cb10-504"><a href="#cb10-504"></a><span class="in">    plot.subtitle = element_text(size = 10, color = "gray30"),</span></span>
<span id="cb10-505"><a href="#cb10-505"></a><span class="in">    plot.caption = element_text(size = 9, hjust = 0),</span></span>
<span id="cb10-506"><a href="#cb10-506"></a><span class="in">    legend.position = "right"</span></span>
<span id="cb10-507"><a href="#cb10-507"></a><span class="in">  ) +</span></span>
<span id="cb10-508"><a href="#cb10-508"></a><span class="in">  # Add annotations about geographic patterns</span></span>
<span id="cb10-509"><a href="#cb10-509"></a><span class="in">  annotate("text", x = 1.5, y = 6100, </span></span>
<span id="cb10-510"><a href="#cb10-510"></a><span class="in">           label = "Gentoo penguins are found exclusively on Biscoe Island,\nsuggesting geographic isolation may have\ncontributed to their distinct morphology", </span></span>
<span id="cb10-511"><a href="#cb10-511"></a><span class="in">           size = 3, color = "grey20", hjust = 0.5)</span></span>
<span id="cb10-512"><a href="#cb10-512"></a><span class="in">```</span></span>
<span id="cb10-513"><a href="#cb10-513"></a></span>
<span id="cb10-514"><a href="#cb10-514"></a>This final visualization reveals the geographic component of our penguin story:</span>
<span id="cb10-515"><a href="#cb10-515"></a></span>
<span id="cb10-516"><a href="#cb10-516"></a><span class="ss">* </span>Species distribution is not uniform across islandsâ€”Gentoo penguins are found exclusively on Biscoe Island.</span>
<span id="cb10-517"><a href="#cb10-517"></a><span class="ss">* </span>Adelie penguins are the most widely distributed, appearing on all three islands.</span>
<span id="cb10-518"><a href="#cb10-518"></a><span class="ss">* </span>Chinstrap penguins are found only on Dream Island.</span>
<span id="cb10-519"><a href="#cb10-519"></a><span class="ss">* </span>These geographic patterns suggest that isolation may have played a role in the evolution of the distinct morphological characteristics we've observed.</span>
<span id="cb10-520"><a href="#cb10-520"></a></span>
<span id="cb10-521"><a href="#cb10-521"></a>The spatial distribution of penguin species adds important context to our understanding of their morphological evolution.</span>
<span id="cb10-522"><a href="#cb10-522"></a></span>
<span id="cb10-523"><a href="#cb10-523"></a><span class="fu"># The Design Philosophy Behind Our Visual Story</span></span>
<span id="cb10-524"><a href="#cb10-524"></a></span>
<span id="cb10-525"><a href="#cb10-525"></a>Creating effective trivariate (and beyond) visualizations requires careful consideration of design principles. Throughout my visual journey,I applied these key principles:</span>
<span id="cb10-526"><a href="#cb10-526"></a></span>
<span id="cb10-527"><a href="#cb10-527"></a><span class="ss">1. </span>**Visual hierarchy**: Using size, color, and opacity to guide attention to the most important elements first.</span>
<span id="cb10-528"><a href="#cb10-528"></a></span>
<span id="cb10-529"><a href="#cb10-529"></a><span class="ss">2. </span>**Perceptual effectiveness**: Matching visual encodings to data typesâ€”position for continuous variables, color for categorical ones, and size for continuous variables of secondary importance.</span>
<span id="cb10-530"><a href="#cb10-530"></a></span>
<span id="cb10-531"><a href="#cb10-531"></a><span class="ss">3. </span>**Annotation**: Adding textual explanations directly on the visualizations to guide interpretation and highlight key insights.</span>
<span id="cb10-532"><a href="#cb10-532"></a></span>
<span id="cb10-533"><a href="#cb10-533"></a><span class="ss">4. </span>**Consistent visual language**: Using the same color scheme throughout to maintain species identification across visualizations.</span>
<span id="cb10-534"><a href="#cb10-534"></a></span>
<span id="cb10-535"><a href="#cb10-535"></a><span class="ss">5. </span>**Progressive disclosure**: Building complexity gradually, from simple three-variable plots to more complex multi-dimensional visualizations.</span>
<span id="cb10-536"><a href="#cb10-536"></a></span>
<span id="cb10-537"><a href="#cb10-537"></a>These principles have allowed us to tell a coherent visual story about penguin morphology that engages viewers and reveals complex ecological and evolutionary patterns.</span>
<span id="cb10-538"><a href="#cb10-538"></a></span>
<span id="cb10-539"><a href="#cb10-539"></a><span class="fu"># Conclusion: The Power of Visual Storytelling with Data</span></span>
<span id="cb10-540"><a href="#cb10-540"></a></span>
<span id="cb10-541"><a href="#cb10-541"></a>My journey through penguin morphology demonstrates how trivariate visualization can transform raw data into a compelling narrative. By thoughtfully combining multiple visual dimensionsâ€”position, color, size, shape, and facetingâ€”I've uncovered complex relationships that tell a rich story about penguin evolution.I love penguins,we love penguins!</span>
<span id="cb10-542"><a href="#cb10-542"></a></span>
<span id="cb10-543"><a href="#cb10-543"></a><span class="fu"># References</span></span>
<span id="cb10-544"><a href="#cb10-544"></a></span>
<span id="cb10-545"><a href="#cb10-545"></a>Horst AM, Hill AP, Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica) penguin data. R package version 0.1.0. https://allisonhorst.github.io/palmerpenguins/</span>
<span id="cb10-546"><a href="#cb10-546"></a></span>
<span id="cb10-547"><a href="#cb10-547"></a>Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org.</span>
<span id="cb10-548"><a href="#cb10-548"></a></span>
<span id="cb10-549"><a href="#cb10-549"></a>Wilke CO (2019). Fundamentals of Data Visualization: A Primer on Making Informative and Compelling Figures. O'Reilly Media. https://clauswilke.com/dataviz/</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>